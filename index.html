<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inovix</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
            <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Orbitron:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/howler@2.2.3/dist/howler.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #00b4ff;
            --secondary: #1e3a8a;
            --accent: #00e676;
            --text: #111827;
            --card-bg: #ffffff;
            --border-black: #000000;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: #ffffff;
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            margin: 0;
            line-height: 1.6;
        }

        h2, h3 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .section h2 {
            color: #000000;
        }

        h3 {
            color: var(--primary);
        }

        @media (min-width: 1024px) {
            h2 { font-size: 2.25rem; }
            h3 { font-size: 1.5rem; }
        }

        #welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            border: 1px solid var(--border-black);
        }

        #welcome-screen h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            color: #ffffff;
        }

        #welcome-screen p {
            font-size: 1.25rem;
            color: #e5e7eb;
            margin-top: 0.5rem;
        }

        .sidebar {
            background: var(--secondary);
            border: 1px solid var(--border-black);
            width: 16rem;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            padding: 1.5rem;
            overflow-y: auto;
            z-index: 10;
        }

        .sidebar button {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: transparent;
            color: #ffffff;
            width: 100%;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .sidebar button::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 230, 118, 0.4), transparent);
            transition: left 0.5s;
        }

        .sidebar button:hover::after {
            left: 100%;
        }

        .sidebar button.active {
            background: var(--accent);
            color: #ffffff;
            font-weight: 700;
        }

        .sidebar button:hover {
            background: rgba(0, 230, 118, 0.3);
            transform: translateX(5px);
        }

        .content {
            margin-left: 16rem;
            height: 100vh;
            overflow-y: auto;
            padding: 2.5rem;
            background: #ffffff;
        }

        .section {
            background: #ffffff;
        }

        .dashboard-element {
            transition: all 0.3s ease;
        }

        .dashboard-element:hover {
            transform: translateY(-3px);
        }

        .holo {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 4px;
            border: 1px solid var(--border-black);
        }

        .holo:hover {
            transform: translateY(-3px);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }

        .modal:not(.hidden) {
            opacity: 1;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 4px;
            border: 1px solid var(--border-black);
            width: 90%;
            max-width: 500px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transform: scale(0.95);
            opacity: 0;
            transition: transform 0.2s ease-out, opacity 0.2s ease-out;
        }

        .modal:not(.hidden) .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        input, select {
            background: var(--card-bg);
            border: 1px solid var(--border-black);
            color: var(--text);
            padding: 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        input:focus, select:focus {
            border-color: var(--accent);
            outline: none;
        }

        button {
            padding: 0.5rem 1rem;
            transition: background-color 0.2s ease;
            border-radius: 4px;
        }

        button:hover {
            transform: none;
        }

        .bg-blue-500 { background-color: #0284ff; }
        .bg-blue-500:hover { background-color: #0059ff; }
        .bg-green-500 { background-color: #00cc66; }
        .bg-green-500:hover { background-color: #00a352; }
        .bg-red-500 { background-color: #ff3333; }
        .bg-red-500:hover { background-color: #e60000; }
        .bg-teal-500 { background-color: #00e6b8; }
        .bg-teal-500:hover { background-color: #00b38f; }
        .bg-indigo-500 { background-color: #7b3eff; }
        .bg-indigo-500:hover { background-color: #5e1aff; }
        .bg-purple-500 { background-color: #a300ff; }
        .bg-purple-500:hover { background-color: #8200cc; }
        .bg-pink-500 { background-color: #ff3399; }
        .bg-pink-500:hover { background-color: #e60073; }
        .bg-yellow-500 { background-color: #ffcc00; }
        .bg-yellow-500:hover { background-color: #e6b800; }
        .bg-cyan-500 { background-color: #00e6ff; }
        .bg-cyan-500:hover { background-color: #00b3cc; }

        table {
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 4px;
            background: var(--card-bg);
            border: 1px solid var(--border-black);
            width: 100%;
        }

        th, td {
            border: 1px solid var(--border-black);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--primary);
            color: #ffffff;
            font-weight: 600;
        }

        td {
            background: var(--card-bg);
        }

        tr:nth-child(even) td {
            background: #f9fafb;
        }

        tr:hover td {
            background: rgba(0, 180, 255, 0.2);
            transition: background 0.2s;
        }

        #dashboard .holo {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        #dashboard .holo i {
            font-size: 2rem;
            color: var(--primary);
            transition: transform 0.3s;
        }

        #dashboard .holo:hover i {
            transform: scale(1.1);
        }

        .scrollable-table-container {
            max-height: 300px;
            overflow-y: auto;
            border-radius: 8px;
            border: 1px solid var(--border-black);
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 0;
                overflow: hidden;
            }
            .sidebar.active {
                width: 100%;
            }
            .content {
                margin-left: 0;
                margin-top: 60px;
                padding: 1.5rem;
            }
            .holo {
                padding: 1.5rem;
            }
            #welcome-screen h1 {
                font-size: 2.5rem;
            }
            #welcome-screen p {
                font-size: 1rem;
            }
        }

        .hidden {
            display: none;
        }

        #modalEditarFiado .modal-content {
            max-width: 500px;
        }

        #modalVerFiado .modal-content {
            max-width: 500px;
        }

        #modalEditarProductoFiar .modal-content {
            max-width: 400px;
        }

        #tablaFiados .btn-ver:hover {
            background-color: #ffaa00 !important;
        }
        #tablaFiados .btn-pagar:hover {
            background-color: #00a352 !important;
        }

        #modalEditarFiado .flex-container {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        #modalEditarFiado .flex-container select {
            flex: 1;
            min-width: 0;
        }

        #modalEditarFiado .flex-container input {
            width: 60px;
        }

        #modalEditarFiado .flex-container button {
            padding: 0.5rem;
            flex-shrink: 0;
        }

        @keyframes fade-in-down {
            0% { opacity: 0; transform: translateY(-30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes fade-in-up {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes quote-reveal {
            0% { opacity: 0; transform: scale(0.95); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes rotatePulse {
            0% { transform: rotate(0deg) scale(1); opacity: 0.3; }
            50% { transform: rotate(180deg) scale(1.1); opacity: 0.5; }
            100% { transform: rotate(360deg) scale(1); opacity: 0.3; }
        }

        @keyframes floatParticle {
            0% { transform: translateY(0) scale(1); opacity: 0.8; }
            50% { transform: translateY(-20px) scale(1.2); opacity: 0.5; }
            100% { transform: translateY(0) scale(1); opacity: 0.8; }
        }

        @keyframes pulseBackground {
            0% { transform: scale(1); opacity: 0.2; }
            50% { transform: scale(1.1); opacity: 0.4; }
            100% { transform: scale(1); opacity: 0.2; }
        }

        .animate-fade-in-down {
            animation: fade-in-down 1s ease-out;
        }

        .animate-fade-in-up {
            animation: fade-in-up 1s ease-out 0.3s forwards;
            opacity: 0;
        }

        .animate-pulse {
            animation: pulse 2s infinite ease-in-out;
        }

        .animate-float {
            animation: float 4s infinite ease-in-out;
        }

        .animate-quote-reveal {
            animation: quote-reveal 0.8s ease-out 0.6s forwards;
            opacity: 0;
        }

        #inicio .header {
    position: relative;
    background: linear-gradient(135deg, #3B82F6, #1D4ED8); /* Degradado azul */
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    padding: 3rem 1.5rem;
    min-height: 350px; /* Altura aumentada */
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
}

#inicio .header::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
    animation: rotate 15s linear infinite;
    z-index: 0;
}

@keyframes rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Gráficos decorativos */
#inicio .header .graphic {
    position: absolute;
    background: rgba(255, 255, 255, 0.1); /* Color semi-transparente */
    z-index: 0;
}

#inicio .header .graphic.circle {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    top: -50px;
    left: -50px;
}

#inicio .header .graphic.triangle {
    width: 0;
    height: 0;
    border-left: 100px solid transparent;
    border-right: 100px solid transparent;
    border-bottom: 150px solid rgba(255, 255, 255, 0.1);
    bottom: -50px;
    right: -50px;
    transform: rotate(45deg);
}

#inicio .header .graphic.square {
    width: 120px;
    height: 120px;
    background: rgba(255, 255, 255, 0.1);
    transform: rotate(45deg);
    top: 50%;
    left: 10%;
}

#inicio .header .graphic.zigzag {
    width: 200px;
    height: 20px;
    background: repeating-linear-gradient(
        45deg,
        rgba(255, 255, 255, 0.1),
        rgba(255, 255, 255, 0.1) 10px,
        transparent 10px,
        transparent 20px
    );
    bottom: 20%;
    right: 10%;
}

#inicio .header-content {
    position: relative;
    z-index: 1;
}

#inicio .header h2 {
    font-size: 3rem;
    line-height: 1.2;
    text-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    color: #FFFFFF;
}

#inicio .header p {
    font-size: 1.5rem;
    color: #E5E7EB;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

#inicio .header button {
    position: relative;
    padding: 0.75rem 2rem;
    background: var(--accent);
    color: #FFFFFF;
    font-weight: 600;
    border: none;
    border-radius: 50px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    overflow: hidden;
    transition: all 0.3s ease;
}

#inicio .header button::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.4s ease, height 0.4s ease;
}

#inicio .header button:hover::after {
    width: 200%;
    height: 200%;
}

#inicio .header button:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}

#dailyQuote {
            position: relative;
            margin: 2rem auto;
            padding: 1.5rem;
            max-width: 600px;
            font-size: 1.5rem;
            font-style: italic;
            color: #2D3748;
            background: #FFFFFF;
            border-radius: 16px;
            border: 2px solid #E2E8F0;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
            line-height: 1.6;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        #dailyQuote:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }

        #dailyQuote::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #667EEA, #764BA2);
        }

        #dailyQuote::after {
            content: '“';
            position: absolute;
            top: 0.5rem;
            left: 1rem;
            font-size: 3rem;
            color: rgba(102, 126, 234, 0.2);
            font-family: serif;
        }

        #dailyQuote p {
            position: relative;
            z-index: 1;
        }

        #dailyQuote .graphic {
            position: absolute;
            width: 100px;
            height: 100px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 50%;
            z-index: 0;
        }

        #dailyQuote .graphic.top-left {
            top: -30px;
            left: -30px;
        }

        #dailyQuote .graphic.bottom-right {
            bottom: -30px;
            right: -30px;
            background: rgba(118, 75, 162, 0.1);
        }
@media (max-width: 768px) {
    #inicio .header {
        padding: 3rem 1.5rem; /* Ajusta el padding para móviles */
        min-height: 300px; /* Ajusta el min-height para móviles */
    }
    #inicio .header h2 {
        font-size: 2.5rem; /* Ajusta el tamaño de la fuente para móviles */
    }
    #inicio .header p {
        font-size: 1.5rem; /* Ajusta el tamaño de la fuente para móviles */
    }
    #inicio .header button {
        padding: 0.5rem 1.5rem;
    }
    #inicio .card {
        padding: 1.5rem;
    }
    #dailyQuote {
        font-size: 1.25rem; /* Ajusta el tamaño de la fuente para móviles */
        padding: 1.5rem 2rem; /* Ajusta el padding para móviles */
        margin: 1.5rem auto;
        max-width: 90%;
    }
    #dailyQuote::before,
    #dailyQuote::after {
        font-size: 2.5rem; /* Ajusta el tamaño de las comillas para móviles */
    }
}

        .reportes-table th, .reportes-table td {
            padding: 1rem;
            font-size: 0.9rem;
        }

        .reportes-table tbody tr:hover {
            background: rgba(0, 180, 255, 0.25);
        }

        .reportes-table tfoot {
            background: #e5e7eb;
            color: var(--text);
        }

        /* Estilos ajustados para Dashboard */
        #dashboard {
            position: relative;
            background: linear-gradient(135deg, #1e3a8a, #00b4ff); /* Fondo igual a Misiones */
            padding: 2rem;
            border-radius: 16px;
            overflow: hidden;
        }

        #dashboard .dashboard-title {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.9);
            z-index: 10;
            padding: 1rem 0;
            text-align: center;
            border-radius: 8px;
        }

        #dashboard::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="rgba(255,255,255,0.1)" fill-opacity="1" d="M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,138.7C672,128,768,160,864,181.3C960,203,1056,213,1152,202.7C1248,192,1344,160,1392,144L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>');
            z-index: 0;
        }

        #dashboard::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(0, 230, 118, 0.2), transparent 70%);
            animation: pulseBackground 10s infinite ease-in-out;
            z-index: 0;
        }

        #dashboard .holo {
            position: relative;
            z-index: 1;
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        #dashboard .holo:hover {
            transform: scale(1.03);
        }

        .dashboard-card {
            position: relative;
            overflow: hidden;
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            z-index: 1;
        }

        .dashboard-card:hover {
            transform: scale(1.03);
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, transparent 70%);
            opacity: 0.1;
            pointer-events: none;
        }

        .dashboard-particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: rgba(255, 215, 0, 0.8);
            border-radius: 50%;
            animation: floatParticle 6s infinite ease-in-out;
            z-index: 0;
        }

        @media (max-width: 768px) {
            #dashboard {
                padding: 1.5rem;
            }
            #dashboard .dashboard-title {
                font-size: 1.75rem;
            }
            #dashboard .holo {
                padding: 1rem;
            }
        }

/* Estilos para la sección de ventas */
#ventas .section {
    background: #f9fafb;
    padding: 2rem;
}

#ventas table th {
    background: #f8fafc;
    color: #4b5563;
    font-weight: 600;
}

#ventas table td {
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
}

#ventas table tr:hover {
    background: #f3f4f6;
}

#ventas .btn-agregar {
    transition: background-color 0.2s ease;
}

#ventas .btn-agregar:hover {
    background-color: #2563eb;
}
/* Estilos para la sección de Fiar */
#fiar .section {
    background: #ffffff; /* Fondo blanco para la sección */
    padding: 2rem;
}

#fiar .max-w-4xl {
    background: #f9fafb; /* Fondo gris claro para el contenedor */
    border: 1px solid #000000; /* Borde fino */
    border-radius: 0.5rem;
}

#fiar input,
#fiar select {
    background: #ffffff;
    border: 1px solid #e5e7eb;
    color: #4b5563;
    padding: 0.75rem;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

#fiar input:focus,
#fiar select:focus {
    border-color: #3b82f6;
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

#fiar button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    font-weight: 500;
    transition: background-color 0.2s ease;
}

#fiar button:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#fiar table {
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 0.375rem;
    background: #ffffff;
    border: 1px solid #e5e7eb;
    width: 100%;
}

#fiar th,
#fiar td {
    border: 1px solid #e5e7eb;
    padding: 0.75rem;
    text-align: left;
}

#fiar th {
    background: #f9fafb;
    color: #4b5563;
    font-weight: 600;
}

#fiar td {
    background: #ffffff;
}

#fiar tr:nth-child(even) td {
    background: #f9fafb;
}

#fiar tr:hover td {
    background: rgba(59, 130, 246, 0.05);
    transition: background 0.2s;
}

#fiar .max-h-96 {
    max-height: 24rem; /* Altura máxima para la barra de desplazamiento */
}

#fiar .overflow-y-auto {
    overflow-y: auto; /* Barra de desplazamiento vertical */
}

/* Estilos para la sección de inventario */
#inventario .section {
    background: #ffffff;
    padding: 2.5rem;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgb(0, 0, 0);
    border: 1px solid rgba(0, 0, 0, 0.05);
    position: relative;
    overflow: hidden;
}

#inventario .section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, #4299e1, #00b4ff);
    opacity: 0.8;
}

#inventario h2 {
    color: #2d3748;
    font-size: 2.25rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    position: relative;
    z-index: 1;
}

#inventario h2::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, #4299e1, #00b4ff);
    border-radius: 2px;
}

#inventario input {
    background: #ffffff;
    border: 1px solid #e2e8f0;
    color: #4a5568;
    padding: 0.75rem 1rem;
    border-radius: 0.75rem;
    font-size: 1rem;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

#inventario input:focus {
    border-color: #4299e1;
    outline: none;
    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
}

#inventario button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.2s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#inventario button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

#inventario table {
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 0.75rem;
    background: #ffffff;
    border: 1px solid #e2e8f0;
    width: 100%;
    overflow: hidden;
}

#inventario th,
#inventario td {
    border: 1px solid #e2e8f0;
    padding: 0.75rem;
    text-align: left;
}

#inventario th {
    background: linear-gradient(145deg, #005eac, #0077e7); /* Fondo azul */
    color: #ffffff;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.875rem;
}

#inventario td {
    background: #ffffff;
    font-size: 0.925rem;
}

#inventario tr:nth-child(even) td {
    background: #f9fafb;
}

#inventario tr:hover td {
    background: rgba(66, 153, 225, 0.05);
    transition: background 0.2s;
}

#inventario .btn-editar {
    background-color: #4299e1;
    color: #ffffff;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

#inventario .btn-editar:hover {
    background-color: #0077ff;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
}

#inventario .btn-eliminar {
    background-color: #e53e3e;
    color: #ffffff;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

#inventario .btn-eliminar:hover {
    background-color: #c53030;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
    }

/* Estilo para productos con bajo stock - Fondo rojo */
tr.producto-bajo-stock td {
    background-color: #ffebee !important;  /* Fondo rojo claro */
    border-color: #ee0000 !important;     /* Borde rojo */
}

/* Mantener el texto legible (negro) */
tr.producto-bajo-stock td {
    color: #000 !important;  /* Texto negro para mejor legibilidad */
}

/* Efecto hover para mantener la consistencia */
tr.producto-bajo-stock:hover td {
    background-color: #ffcdd2 !important;  /* Rojo un poco más intenso al hacer hover */
}

/* Estilos para la sección de clientes */
#clientes .section {
    background: #ffffff;
    padding: 2.5rem;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.05);
    position: relative;
    overflow: hidden;
}

#clientes .section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, #4299e1, #00b4ff);
    opacity: 0.8;
}

#clientes h2 {
    color: #2d3748;
    font-size: 2.25rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    position: relative;
    z-index: 1;
}

#clientes h2::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, #4299e1, #00b4ff);
    border-radius: 2px;
}

#clientes input {
    background: #ffffff;
    border: 1px solid #e2e8f0;
    color: #4a5568;
    padding: 0.75rem 1rem;
    border-radius: 0.75rem;
    font-size: 1rem;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

#clientes input:focus {
    border-color: #4299e1;
    outline: none;
    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
}

#clientes table {
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 0.75rem;
    background: #ffffff;
    border: 1px solid #e2e8f0;
    width: 100%;
    overflow: hidden;
}

#clientes th,
#clientes td {
    border: 1px solid #e2e8f0;
    padding: 0.75rem;
    text-align: left;
}

#clientes th {
    background: linear-gradient(145deg, #005eac, #0077e7); /* Fondo azul */
    color: #ffffff;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.875rem;
}

#clientes td {
    background: #ffffff;
    font-size: 0.925rem;
}

#clientes tr:nth-child(even) td {
    background: #f9fafb;
}

#clientes tr:hover td {
    background: rgba(66, 153, 225, 0.05);
    transition: background 0.2s;
}

#clientes .btn-eliminar {
    background-color: #e53e3e;
    color: #ffffff;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

#clientes .btn-eliminar:hover {
    background-color: #c53030;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
}

/* Estilos para la sección de proveedores */
#proveedores .section {
    background: #ffffff;
    padding: 2.5rem;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.05);
    position: relative;
    overflow: hidden;
}

#proveedores .section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, #4299e1, #00b4ff);
    opacity: 0.8;
}

#proveedores h2 {
    color: #2d3748;
    font-size: 2.25rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    position: relative;
    z-index: 1;
}

#proveedores h2::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, #4299e1, #00b4ff);
    border-radius: 2px;
}

#proveedores button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.2s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#proveedores button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

#proveedores table {
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 0.75rem;
    background: #ffffff;
    border: 1px solid #e2e8f0;
    width: 100%;
    overflow: hidden;
}

#proveedores th,
#proveedores td {
    border: 1px solid #e2e8f0;
    padding: 0.75rem;
    text-align: left;
}

#proveedores th {
    background: linear-gradient(145deg, #005eac, #0077e7); /* Fondo azul */
    color: #ffffff;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.875rem;
}

#proveedores td {
    background: #ffffff;
    font-size: 0.925rem;
}

#proveedores tr:nth-child(even) td {
    background: #f9fafb;
}

#proveedores tr:hover td {
    background: rgba(66, 153, 225, 0.05);
    transition: background 0.2s;
}

#proveedores .btn-eliminar {
    background-color: #e53e3e;
    color: #ffffff;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

#proveedores .btn-eliminar:hover {
    background-color: #c53030;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
}

/* Estilos para la sección de Reportes */
#reportes {
    background: linear-gradient(145deg, #ffffff, #f8fafc);
    padding: 2.5rem;
    border-radius: 20px;
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.05);
    position: relative;
    overflow: hidden;
}

#reportes h2 {
    color: #000000; /* Cambiado a negro */
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 1.5rem;
    position: relative;
    z-index: 1;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 1px;
    /* Eliminado el gradiente en el texto */
}

#reportes h2::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 4px;
    background: linear-gradient(90deg, #4299e1, #00b4ff); /* Línea decorativa con gradiente */
    border-radius: 2px;
}
#reportes .filtros-container {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

#reportes .filtros-container label {
    font-weight: 600;
    color: #4a5568;
    margin-bottom: 0.5rem;
    display: block;
}

#reportes .filtros-container input,
#reportes .filtros-container select {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    background: #ffffff;
}

#reportes .filtros-container input:focus,
#reportes .filtros-container select:focus {
    border-color: #4299e1;
    outline: none;
    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
}

#reportes .filtros-container button {
    width: 100%;
    padding: 0.75rem;
    background: #4299e1;
    color: #ffffff;
    border: none;
    border-radius: 8px;
    font-size: 0.9rem;
    font-weight: 600;
    transition: all 0.3s ease;
}

#reportes .filtros-container button:hover {
    background: #3182ce;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

#reportes .graficos-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

#reportes .grafico-card {
    background: #ffffff;
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

#reportes .grafico-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

#reportes .grafico-card h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 1rem;
    text-align: center;
}

#reportes .scrollable-table-container {
    max-height: 500px;
    overflow-y: auto;
    border-radius: 12px;
    border: 1px solid #e2e8f0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

#reportes .reportes-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 12px;
    overflow: hidden;
}

#reportes .reportes-table th,
#reportes .reportes-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #e2e8f0;
}

#reportes .reportes-table th {
    background: linear-gradient(145deg, #005eac, #0077e7);
    color: #ffffff;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.875rem;
    position: sticky;
    top: 0;
    z-index: 1;
}

#reportes .reportes-table td {
    background: #ffffff;
    font-size: 0.925rem;
}

#reportes .reportes-table tr:nth-child(even) td {
    background: #f9fafb;
}

#reportes .reportes-table tr:hover td {
    background: rgba(66, 153, 225, 0.05);
    transition: background 0.2s;
}

#reportes .reportes-table tfoot {
    background: #f9fafb;
    color: #2d3748;
}

#reportes .reportes-table tfoot td {
    font-weight: 600;
    background: #f9fafb;
}

#reportes .btn-descargar {
    background-color: #4299e1;
    color: #ffffff;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#reportes .btn-descargar:hover {
    background-color: #3182ce;
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
}
/* Estilos para la sección de Configuración */
#config {
    background: #eff6ff; /* Azul claro suave */
    padding: 2rem;
    min-height: 100vh; /* Cubre toda la altura de la pantalla */
}

#config h2 {
    font-family: 'Roboto', sans-serif; /* Fuente limpia y moderna */
    font-size: 2.5rem;
    font-weight: 700;
    color: #2d3748; /* Gris oscuro */
    text-align: center;
    position: relative;
    margin-bottom: 2rem;
}

#config h2 span {
    display: block;
    width: 64px;
    height: 3px;
    background: #3b82f6; /* Azul vibrante */
    border-radius: 2px;
    margin: 0.5rem auto 0;
    transition: width 0.3s ease;
}

#config h2:hover span {
    width: 96px; /* La línea crece al hacer hover */
}

/* Estilos para el formulario */
#config form {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
    border-radius: 1.5rem;
    padding: 2rem;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

#config form:hover {
    transform: translateY(-5px);
    box-shadow: 0 16px 32px rgba(0, 0, 0, 0.15);
}

#config input, #config select {
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(209, 213, 219, 0.5);
    color: #4a5568;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    font-size: 1rem;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

#config input:focus, #config select:focus {
    border-color: rgba(59, 130, 246, 0.5); /* Azul */
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); /* Azul */
}

#config button {
    padding: 0.75rem 1.5rem;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#config button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

#config form {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgb(0, 0, 0);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
    border-radius: 1.5rem;
    padding: 2rem;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

#config form:hover {
    transform: translateY(-5px);
    box-shadow: 0 16px 32px rgba(0, 0, 0, 0.15);
}

#config input, #config select {
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(209, 213, 219, 0.5);
    color: #4a5568;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    font-size: 1rem;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

#config input:focus, #config select:focus {
    border-color: rgba(147, 51, 234, 0.5); /* Morado */
    outline: none;
    box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.1); /* Morado */
}

#config button {
    padding: 0.75rem 1.5rem;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#config button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

   /* Animación de entrada para todas las secciones */
   .fade-in {
            animation: fade-in-down 0.5s ease-out forwards;
            opacity: 0;
        }

        @keyframes fade-in-down {
            0% {
                opacity: 0;
                transform: translateY(-20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hidden {
            display: none;
        }

    </style>
</head>
<body>
    <!-- Pantalla de Bienvenida -->
    <div id="welcome-screen">
        <h1>Inovix</h1>
        <p>Bienvenido a tu sistema de gestión empresarial</p>
        <button onclick="document.getElementById('welcome-screen').style.display='none'" class="mt-6 px-6 py-2 bg-teal-500 text-white hover:bg-teal-600">Comenzar</button>
    </div>

    <!-- Sistema Principal -->
    <div id="sistema" class="flex">
        <!-- Botón Hamburguesa para móviles -->
        <div class="md:hidden p-4 fixed top-0 left-0 z-20">
            <button onclick="document.getElementById('sidebar').classList.toggle('active')" class="text-black">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </div>

        <!-- Sidebar -->
        <div id="sidebar" class="sidebar p-4 flex flex-col">
            <h2 id="businessName" class="text-2xl font-bold mb-6 text-white">Mi Negocio</h2>
            <nav class="space-y-2 flex-grow">
                <button onclick="mostrarSeccion('inicio')" id="nav-inicio" class="active"><i class="fas fa-home"></i> Inicio</button>
                <button onclick="mostrarSeccion('dashboard')" id="nav-dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</button>
                <button onclick="mostrarSeccion('inventario')" id="nav-inventario"><i class="fas fa-boxes"></i> Inventario</button>
                <button onclick="mostrarSeccion('ventas')" id="nav-ventas"><i class="fas fa-shopping-cart"></i> Ventas</button>
                <button onclick="mostrarSeccion('clientes')" id="nav-clientes"><i class="fas fa-users"></i> Clientes</button>
                <button onclick="mostrarSeccion('fiar')" id="nav-fiar"><i class="fas fa-handshake"></i> Fiar</button>
                <button onclick="mostrarSeccion('reportes')" id="nav-reportes"><i class="fas fa-chart-line"></i> Reportes</button>
                <button onclick="mostrarSeccion('proveedores')" id="nav-proveedores"><i class="fas fa-truck"></i> Proveedores</button>
                <button onclick="mostrarSeccion('config')" id="nav-config"><i class="fas fa-cog"></i> Configuración</button>
            </nav>
        </div>

                    <!-- Contenido -->
        <div class="flex-1 content p-6">
            <div id="welcome-placeholder"></div>
            <!-- Sección Inicio Mejorada -->
            <div id="inicio" class="section fade-in">
                <div class="header">
                    <div class="graphic circle"></div>
                    <div class="graphic triangle"></div>
                    <div class="graphic square"></div>
                    <div class="graphic zigzag"></div>
                    <div class="header-content">
                        <h2 class="animate-fade-in-down">Bienvenido a Inovix</h2>
                        <p class="animate-fade-in-up">Tu solución integral para la gestión empresarial</p>
                        <button onclick="mostrarSeccion('dashboard')" class="mt-8 animate-pulse">Explorar Ahora</button>
                    </div>
                </div>

                <p id="dailyQuote" class="animate-quote-reveal"></p>

                

                <div class="mt-8 text-center">
                    <p class="text-sm text-gray-500">Desarrollado por <strong class="text-teal-600">Inovixe</strong></p>
                </div>
            </div>
<!-- Dashboard -->
<div id="dashboard" class="section hidden fade-in">
    <div class="relative">
        <h2 class="dashboard-title text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-teal-500 animate-fade-in-down">Dashboard</h2>
        
        <!-- Tarjetas superiores -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mt-6">
            <div class="p-6 holo dashboard-card">
                <i class="fas fa-dollar-sign"></i>
                <div>
                    <p class="font-bold text-blue-400">Ventas Hoy</p>
                    <p id="ventasHoy" class="text-2xl">Cargando...</p>
                    <p id="rendimiento" class="text-sm text-gray-400">Cargando...</p>
                </div>
            </div>
            <div class="p-6 holo dashboard-card">
                <i class="fas fa-exclamation-triangle"></i>
                <div>
                    <p class="font-bold text-yellow-400">Stock Bajo</p>
                    <p id="stockBajo" class="text-2xl">Cargando...</p>
                </div>
            </div>
            <div class="p-6 holo dashboard-card">
                <i class="fas fa-users"></i>
                <div>
                    <p class="font-bold text-green-400">Clientes</p>
                    <p id="totalClientes" class="text-2xl">Cargando...</p>
                </div>
            </div>
            <div class="p-6 holo dashboard-card">
                <i class="fas fa-handshake"></i>
                <div>
                    <p class="font-bold text-purple-400">Fiados Pendientes</p>
                    <p id="fiadosPendientes" class="text-2xl">Cargando...</p>
                </div>
            </div>
        </div>

        <!-- Sección gráfica y dólar -->
        <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mt-6">
            <div class="holo p-4 dashboard-card md:col-span-3">
                <canvas id="ventasChart"></canvas>
            </div>
            <div class="holo p-6 dashboard-card md:col-span-2 flex flex-col justify-center">
                <div class="text-center">
                    <i class="fas fa-exchange-alt text-blue-400 text-2xl mb-2"></i>
                    <p class="font-bold text-blue-400 text-lg mb-1">Tasa del Dólar</p>
                    <p id="tasaDolar" class="text-3xl font-bold">Cargando...</p>
                </div>
            </div>
        </div>

        <!-- Partículas -->
        <div class="absolute inset-0 pointer-events-none">
            <div class="dashboard-particle" style="top: 20%; left: 10%;"></div>
            <div class="dashboard-particle" style="top: 70%; left: 60%; animation-delay: 0.5s;"></div>
            <div class="dashboard-particle" style="top: 50%; left: 80%; animation-delay: 1s;"></div>
        </div>
    </div>
</div>
<!-- Inventario -->
<div id="inventario" class="section hidden fade-in">
    <h2 class="text-3xl font-bold mb-6 text-gray-800">Gestión de Inventario</h2>
    <div class="flex gap-4 mb-6">
        <input type="text" id="buscarInventario" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all" placeholder="Buscar producto" oninput="filtrarInventario()">
        <button onclick="abrirModal('modalProducto')" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
            <i class="fas fa-plus"></i> Agregar Producto
        </button>
    </div>
    <div class="overflow-x-auto rounded-lg shadow-lg">
        <table class="w-full border-collapse">
            <thead class="bg-gray-800 text-white">
                <tr>
                    <th class="p-3 text-left">Nombre</th>
                    <th class="p-3 text-left">P. Compra (Bs)</th>
                    <th class="p-3 text-left">P. Compra (USD)</th>
                    <th class="p-3 text-left">P. Venta (Bs)</th>
                    <th class="p-3 text-left">P. Venta (USD)</th>
                    <th class="p-3 text-left">Stock</th>
                    <th class="p-3 text-left">Acciones</th>
                </tr>
            </thead>
            <tbody id="tablaInventario" class="bg-white divide-y divide-gray-200">
                <!-- Filas de productos se llenan dinámicamente -->
            </tbody>
        </table>
    </div>
</div>

<!-- Sección de Ventas Compacta con Scroll y Teléfono -->
<div id="ventas" class="section hidden fade-in flex justify-center items-center min-h-screen bg-gray-50">
    <div class="w-full max-w-4xl mx-4 bg-white rounded-xl shadow-lg overflow-hidden">
        <!-- Título centrado -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 p-4">
            <h2 class="text-2xl font-bold text-center" style="color: white !important;">Registrar Venta</h2>
        </div>

        <!-- Contenedor principal -->
        <div class="p-6">
            <!-- Paneles superiores juntos -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Panel de Búsqueda y Selección de Productos -->
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h3 class="text-base font-semibold mb-3 text-gray-700">Agregar Productos</h3>
                    <input
                        type="text"
                        id="buscarProductoVenta"
                        class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm"
                        placeholder="Buscar producto..."
                        oninput="filtrarProductos('productosVenta')"
                    />
                    <select
                        id="productosVenta"
                        class="w-full p-2 mt-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm"
                    >
                        <!-- Opciones de productos se llenan dinámicamente -->
                    </select>
                    <input
                        type="number"
                        id="cantidadVenta"
                        class="w-full p-2 mt-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm"
                        placeholder="Cantidad"
                        min="1"
                    />
                    <button
                        onclick="agregarProductoVenta()"
                        class="w-full mt-3 bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 transition-colors text-sm"
                    >
                        <i class="fas fa-cart-plus mr-2"></i>Agregar al Carrito
                    </button>
                </div>

                <!-- Información del Cliente -->
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h3 class="text-base font-semibold mb-3 text-gray-700">Datos del Cliente</h3>
                    <input
                        type="text"
                        id="nombreClienteVenta"
                        list="clientesList"
                        class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm"
                        placeholder="Nombre del Cliente (Opcional)"
                    />
                    <input
                    type="text"
                    id="telefonoClienteVenta"
                    class="w-full p-2 mt-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm"
                    placeholder="Teléfono (Opcional)"
                />
                    <datalist id="clientesList"></datalist>
                </div>
            </div>

            <!-- Carrito de Venta con Scroll -->
            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                <h3 class="text-base font-semibold mb-3 text-gray-700">Carrito de Venta</h3>
                <div class="overflow-x-auto max-h-64 overflow-y-auto">
                    <table class="w-full border-collapse text-sm">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="p-2 text-left text-gray-600">Producto</th>
                                <th class="p-2 text-left text-gray-600">Cantidad</th>
                                <th class="p-2 text-left text-gray-600">Precio Unitario</th>
                                <th class="p-2 text-left text-gray-600">Total</th>
                                <th class="p-2 text-left text-gray-600">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="detalleVenta" class="divide-y divide-gray-200">
                            <!-- Filas de productos se llenan dinámicamente -->
                        </tbody>
                    </table>
                </div>

                <!-- Totales -->
                <div class="mt-4 p-3 bg-white rounded-md shadow-sm">
                    <p class="text-base font-semibold">
                        <strong>Total en Bolívares:</strong>
                        <span id="totalBsVenta" class="text-blue-600">0.00</span>
                    </p>
                    <p class="text-base font-semibold">
                        <strong>Total en Dólares:</strong>
                        <span id="totalUsdVenta" class="text-blue-600">0.00</span>
                    </p>
                </div>

                <!-- Botones de Acción -->
                <div class="mt-4 flex space-x-3">
                    <button
                        onclick="finalizarVenta()"
                        class="flex-1 bg-green-600 text-white p-2 rounded-md hover:bg-green-700 transition-colors text-sm"
                    >
                        <i class="fas fa-check-circle mr-2"></i>Finalizar Venta
                    </button>
                    <button
                        onclick="imprimirTicket('venta')"
                        class="flex-1 bg-gray-600 text-white p-2 rounded-md hover:bg-gray-700 transition-colors text-sm"
                    >
                        <i class="fas fa-print mr-2"></i>Imprimir Ticket
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
        <!-- Clientes -->
<div id="clientes" class="section hidden fade-in">
    <h2 class="text-3xl font-bold mb-6 text-gray-800">Clientes Registrados</h2>
    <div class="flex gap-4 mb-6">
        <input type="text" id="buscarCliente" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all" placeholder="Buscar cliente" oninput="filtrarClientes()">
    </div>
    <div class="overflow-x-auto rounded-lg shadow-lg">
        <table class="w-full border-collapse">
            <thead class="bg-gray-800 text-white">
                <tr>
                    <th class="p-3 text-left">Nombre</th>
                    <th class="p-3 text-left">Teléfono</th>
                    <th class="p-3 text-left">Acciones</th>
                </tr>
            </thead>
            <tbody id="tablaClientes" class="bg-white divide-y divide-gray-200">
                <!-- Filas de clientes se llenan dinámicamente -->
            </tbody>
        </table>
    </div>
</div>

<!-- Sección Fiar Mejorada -->
<div id="fiar" class="section hidden fade-in">
    <div class="max-w-4xl mx-auto p-6 bg-gray-50 rounded-lg border border-gray-300">
        <!-- Título centrado con el mismo estilo que "Ventas" -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 p-4 mb-6">
            <h2 class="text-2xl font-bold text-center" style="color: white !important;">Clientes que Fían</h2>
        </div>

        <!-- Búsqueda y selección de productos -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Buscar Producto</label>
                <input type="text" id="buscarProductoFiar" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Buscar producto" oninput="filtrarProductos('productosFiar')">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Seleccionar Producto</label>
                <select id="productosFiar" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></select>
            </div>
        </div>

        <!-- Cantidad y botón de agregar -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Cantidad</label>
                <input type="number" id="cantidadFiar" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Cantidad">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Nombre del Cliente</label>
                <input type="text" id="nombreClienteFiar" list="clientesListFiar" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nombre del Cliente" required>
                <datalist id="clientesListFiar"></datalist>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Teléfono del Cliente</label>
                <input type="text" id="telefonoClienteFiar" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Teléfono del Cliente">
            </div>
        </div>

        <!-- Botón de agregar producto -->
        <div class="flex justify-end mb-6">
            <button onclick="agregarProductoFiar()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">Agregar Producto</button>
        </div>

        <!-- Tabla de productos fiados -->
        <div class="overflow-x-auto">
            <table class="w-full border-collapse">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="p-3 text-left text-gray-700">Producto</th>
                        <th class="p-3 text-left text-gray-700">Cantidad</th>
                        <th class="p-3 text-left text-gray-700">Acciones</th>
                    </tr>
                </thead>
                <tbody id="detalleFiar" class="divide-y divide-gray-200"></tbody>
            </table>
        </div>

        <!-- Botón de guardar fiado -->
        <div class="mt-6">
            <button onclick="guardarFiado()" class="w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">Guardar Fiado</button>
        </div>

        <!-- Tabla de fiados registrados con barra de desplazamiento -->
        <div class="mt-8">
            <h3 class="text-2xl font-bold mb-4 text-gray-800 text-center">Fiados Registrados</h3>
            <div class="overflow-x-auto max-h-96 overflow-y-auto border border-gray-300 rounded-lg">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="p-3 text-center text-gray-700">Fecha</th>
                            <th class="p-3 text-center text-gray-700">Cliente</th>
                            <th class="p-3 text-center text-gray-700">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="tablaFiados" class="divide-y divide-gray-200"></tbody>
                </table>
            </div>
        </div>
    </div>
    </div>
<!-- Sección de Reportes -->
<div id="reportes" class="section hidden fade-in">
    <!-- Título de la sección en negro -->
    <h2>Reportes de Ventas</h2>

    <!-- Contenedor de filtros -->
    <div class="filtros-container">
        <form id="filtrosReporte" class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <!-- Filtro por nombre del cliente -->
            <div>
                <label for="buscarVenta">Buscar Cliente</label>
                <input type="text" id="buscarVenta" placeholder="Nombre del cliente" oninput="filtrarVentas()">
            </div>

            <!-- Filtro por fecha -->
            <div>
                <label for="filtroFecha">Fecha</label>
                <input type="date" id="filtroFecha" onchange="filtrarVentas()">
            </div>

            <!-- Filtro por tipo de reporte -->
            <div>
                <label for="tipoReporte">Tipo de Reporte</label>
                <select id="tipoReporte" onchange="filtrarVentas()">
                    <option value="diario">Diario</option>
                    <option value="semanal">Semanal</option>
                    <option value="mensual">Mensual</option>
                </select>
            </div>

            <!-- Botón para limpiar filtros -->
            <div class="flex items-end">
                <button type="button" onclick="limpiarFiltros()">Limpiar Filtros</button>
            </div>
        </form>
    </div>

    <!-- Tabla de reportes -->
    <div class="scrollable-table-container">
        <table class="reportes-table">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Cliente</th>
                    <th class="text-right">Total (Bs)</th>
                    <th class="text-right">Total (USD)</th>
                    <th class="text-center">Acciones</th>
                </tr>
            </thead>
            <tbody id="reporteVentasBody">
                <!-- Las filas de reportes se llenarán dinámicamente -->
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="2" class="text-right font-bold">Total General:</td>
                    <td class="text-right font-bold" id="totalBsReporte">0.00</td>
                    <td class="text-right font-bold" id="totalUsdReporte">0.00</td>
                    <td></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <!-- Botón para descargar reporte en PDF -->
    <div class="flex justify-end mt-4">
        <button class="btn-descargar" onclick="descargarReporteVentasPDF()">Descargar PDF</button>
    </div>
</div>
  <!-- Modal para Detalles de Venta -->
  <div id="modalVerVenta" class="modal hidden">
    <div class="modal-content">
        <h3 class="text-lg font-bold mb-2">Detalles de la Venta</h3>
        <div id="detalleVerVenta" class="space-y-2"></div>
        <div class="flex space-x-2 mt-4">
            <button onclick="cerrarModal('modalVerVenta')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
        </div>
    </div>
</div>

      <!-- Proveedores -->
<div id="proveedores" class="section hidden fade-in">
    <h2 class="text-3xl font-bold mb-6 text-gray-800">Gestión de Proveedores</h2>
    <div class="flex gap-4 mb-6">
        <button onclick="abrirModal('modalProveedor')" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2">
            <i class="fas fa-plus"></i> Agregar Proveedor
        </button>
    </div>
    <div class="overflow-x-auto rounded-lg shadow-lg">
        <table class="w-full border-collapse">
            <thead class="bg-gray-800 text-white">
                <tr>
                    <th class="p-3 text-left">Nombre</th>
                    <th class="p-3 text-left">Contacto</th>
                    <th class="p-3 text-left">Productos</th>
                    <th class="p-3 text-left">Acciones</th>
                </tr>
            </thead>
            <tbody id="tablaProveedores" class="bg-white divide-y divide-gray-200">
                <!-- Filas de proveedores se llenan dinámicamente -->
            </tbody>
        </table>
    </div>
</div>

<div id="config" class="section hidden fade-in bg-blue-50">
    <h2 class="text-4xl font-bold mb-8 text-center text-gray-800" style="font-family: 'Orbitron', sans-serif; font-weight: 700;">
        Configuración
        <span class="block w-16 h-1.5 bg-blue-500 rounded-full mx-auto mt-3"></span>
    </h2>
    <form id="formConfig" onsubmit="event.preventDefault(); guardarConfig();" class="max-w-2xl mx-auto bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
        <!-- Nombre del Negocio -->
        <div class="mb-8">
            <label class="block text-sm font-medium text-gray-600 mb-2">Nombre del Negocio</label>
            <input type="text" id="configBusinessName" class="w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400 text-gray-700" placeholder="Ingresa el nombre de tu negocio">
        </div>
        <!-- Tasa del Dólar -->
        <div class="mb-8">
            <label class="block text-sm font-medium text-gray-600 mb-2">Tasa del Dólar (Bs/USD)</label>
            <input type="number" id="configTasaDolar" class="w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400 text-gray-700" placeholder="Ej: 43.50" step="0.01">
        </div>
        <!-- Modo de Tasa -->
        <div class="mb-8">
            <label class="block text-sm font-medium text-gray-600 mb-2">Modo de Tasa</label>
            <select id="configTasaModo" class="w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white text-gray-700">
                <option value="manual">Manual</option>
                <option value="automatico">Automático</option>
            </select>
        </div>
        <!-- Botón de Guardar -->
        <div class="flex justify-end">
            <button type="submit" class="px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-all flex items-center gap-2 shadow-lg hover:shadow-xl">
                <i class="fas fa-save"></i> Guardar Cambios
            </button>
        </div>
    </form>
</div>
            <!-- Modales Optimizados -->
            <div id="modalProducto" class="modal hidden">
                <div class="modal-content">
                    <h3 class="text-lg font-bold mb-2">Agregar Producto</h3>
                    <form id="formProducto" class="space-y-2">
                        <input type="text" id="nombreProducto" class="w-full" placeholder="Nombre">
                        <input type="number" id="precioCompraBs" class="w-full" placeholder="Precio Compra (Bs)" step="0.01">
                        <input type="number" id="precioCompraUsd" class="w-full" placeholder="Precio Compra (USD)" step="0.01">
                        <input type="number" id="precioVentaUsd" class="w-full" placeholder="Precio Venta (USD)" step="0.01" oninput="calcularPrecioVentaBs()">
                        <input type="number" id="precioVentaBs" class="w-full" placeholder="Precio Venta (Bs)" step="0.01" oninput="calcularPrecioVentaUsd()">
                        <input type="number" id="stockProducto" class="w-full" placeholder="Stock">
                        <div class="flex space-x-2">
                            <button type="submit" class="flex-1 bg-blue-500 text-white hover:bg-blue-600">Guardar</button>
                            <button type="button" onclick="cerrarModal('modalProducto')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
                        </div>
                    </form>
                </div>
            </div>

    

            <div id="modalEditarProducto" class="modal hidden">
                <div class="modal-content">
                    <h3 class="text-lg font-bold mb-2">Editar Producto</h3>
                    <form id="formEditarProducto" class="space-y-2">
                        <input type="hidden" id="editProductoIndex">
                        <input type="text" id="editNombreProducto" class="w-full" placeholder="Nombre" required>
                        <input type="number" id="editPrecioCompraBs" class="w-full" placeholder="Precio Compra (Bs)" step="0.01" required>
                        <input type="number" id="editPrecioCompraUsd" class="w-full" placeholder="Precio Compra (USD)" step="0.01" required>
                        <input type="number" id="editPrecioVentaUsd" class="w-full" placeholder="Precio Venta (USD)" step="0.01" required oninput="actualizarPrecioVentaBs()">
                        <input type="number" id="editPrecioVentaBs" class="w-full" placeholder="Precio Venta (Bs)" step="0.01" required oninput="actualizarPrecioVentaUsd()">
                        <input type="number" id="editStockProducto" class="w-full" placeholder="Stock" required>
                        <div class="flex space-x-2">
                            <button type="submit" class="flex-1 bg-blue-500 text-white hover:bg-blue-600">Guardar</button>
                            <button type="button" onclick="cerrarModal('modalEditarProducto')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
                        </div>
                    </form>
                </div>
            </div>
            </div>

            <div id="modalEditarProductoVenta" class="modal hidden">
                <div class="modal-content">
                    <h3 class="text-lg font-bold mb-2">Editar Producto en Venta</h3>
                    <form id="formEditarProductoVenta" class="space-y-2">
                        <input type="hidden" id="editProductoVentaIndex">
                        <input type="text" id="editNombreProductoVenta" class="w-full" readonly>
                        <input type="number" id="editCantidadProductoVenta" class="w-full" placeholder="Cantidad" required>
                        <div class="flex space-x-2">
                            <button type="submit" class="flex-1 bg-yellow-500 text-white hover:bg-yellow-600">Guardar</button>
                            <button type="button" onclick="cerrarModal('modalEditarProductoVenta')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="modalEditarProductoFiar" class="modal hidden">
                <div class="modal-content">
                    <h3 class="text-lg font-bold mb-2">Editar Producto en Fiado</h3>
                    <form id="formEditarProductoFiar" class="space-y-2">
                        <input type="hidden" id="editProductoFiarIndex">
                        <input type="text" id="editNombreProductoFiar" class="w-full" readonly>
                        <input type="number" id="editCantidadProductoFiar" class="w-full" placeholder="Cantidad" required>
                        <div class="flex space-x-2">
                            <button type="submit" class="flex-1 bg-teal-500 text-white hover:bg-teal-600">Guardar</button>
                            <button type="button" onclick="cerrarModal('modalEditarProductoFiar')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="modalProveedor" class="modal hidden">
                <div class="modal-content">
                    <h3 class="text-lg font-bold mb-2">Agregar Proveedor</h3>
                    <form id="formProveedor" class="space-y-2">
                        <input type="text" id="nombreProveedor" class="w-full" placeholder="Nombre" required>
                        <input type="text" id="contactoProveedor" class="w-full" placeholder="Contacto" required>
                        <input type="text" id="productosProveedor" class="w-full" placeholder="Productos (separados por coma)">
                        <div class="flex space-x-2">
                            <button type="submit" class="flex-1 bg-green-500 text-white hover:bg-green-600">Guardar</button>
                            <button type="button" onclick="cerrarModal('modalProveedor')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="modalEditarFiado" class="modal hidden">
                <div class="modal-content">
                    <h2 class="text-xl font-bold mb-2">Editar Fiado</h2>
                    <form id="formEditarFiado" class="space-y-2">
                        <input type="hidden" id="editFiadoIndex">
                        <input type="text" id="editClienteFiado" class="w-full" placeholder="Nombre del Cliente">
                        <div class="flex-container">
                            <select id="editProductosFiado" class="flex-1"></select>
                            <input type="number" id="editCantidadFiado" placeholder="Cantidad">
                            <button type="button" onclick="agregarProductoEditarFiado()" class="bg-teal-500 text-white hover:bg-teal-600">Agregar</button>
                        </div>
                        <div class="max-h-40 overflow-y-auto">
                            <table class="w-full border-collapse">
                                <thead>
                                    <tr class="bg-gray-700">
                                        <th class="border p-1 text-white">Producto</th>
                                        <th class="border p-1 text-white">Cantidad</th>
                                        <th class="border p-1 text-white">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="detalleEditarFiado"></tbody>
                            </table>
                        </div>
                        <div class="flex space-x-2 mt-2">
                            <button type="submit" class="flex-1 bg-indigo-500 text-white hover:bg-indigo-600">Guardar Cambios</button>
                            <button type="button" onclick="cerrarModal('modalEditarFiado')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
                        </div>
                    </form>
                </div>
                </div>

            <div id="modalVerFiado" class="modal hidden">
                <div class="modal-content">
                    <h3 class="text-lg font-bold mb-2">Detalles de Fiado</h3>
                    <div id="detalleVerFiado" class="space-y-2"></div>
                    <div class="flex space-x-2 mt-2">
                        <button onclick="cerrarModal('modalVerFiado')" class="flex-1 bg-red-500 text-white hover:bg-red-600">Cerrar</button>
                    </div>
                </div>
            </div>

            <!-- Ticket -->
            <div id="ticket" class="hidden">
                <h3 id="ticketBusinessName" class="text-lg font-bold"></h3>
                <div id="ticketDetalle"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
// Lista de frases motivadoras
const quotes = [
    "El éxito es la suma de pequeños esfuerzos repetidos día tras día.",
    "No dejes para mañana lo que puedes empezar hoy.",
    "Cada paso que das te acerca a tus sueños.",
    "El único límite es el que te pones tú mismo.",
    "Con esfuerzo y dedicación, todo es posible.",
    "Hoy es un gran día para hacer grandes cosas.",
    "La perseverancia convierte los sueños en logros.",
    "Cree en ti y el resto vendrá solo.",
    "Pequeñas victorias llevan a grandes triunfos.",
    "El trabajo duro siempre da frutos.",
    "La disciplina es el puente entre las metas y los logros.",
    "Enfócate en el progreso, no en la perfección.",
    "Cada desafío es una oportunidad para crecer.",
    "La excelencia no es un acto, sino un hábito.",
    "Tu actitud determina tu dirección.",
    "El fracaso es solo una lección, no un destino.",
    "Invierte en tu crecimiento personal y profesional.",
    "La consistencia es la clave del éxito.",
    "No esperes oportunidades, créalas.",
    "La pasión impulsa el rendimiento.",
    "Sé la mejor versión de ti mismo cada día.",
    "El conocimiento es poder, pero la acción lo hace realidad.",
    "La innovación comienza fuera de la zona de confort.",
    "El liderazgo se construye con acciones, no con palabras.",
    "La resiliencia supera cualquier obstáculo.",
    "La claridad de propósito impulsa el éxito.",
    "Trabaja en silencio, deja que el éxito hable por ti.",
    "La mentalidad de crecimiento abre puertas infinitas.",
    "La productividad es hacer más con menos estrés.",
    "El aprendizaje continuo es la base del progreso.",
    "La confianza en uno mismo atrae oportunidades.",
    "La paciencia y la persistencia siempre ganan.",
    "Sé proactivo, no reactivo.",
    "La creatividad resuelve problemas complejos.",
    "La humildad y la ambición pueden coexistir.",
    "La eficiencia es hacer las cosas bien; la efectividad es hacer las correctas.",
    "El tiempo es tu recurso más valioso, úsalo sabiamente.",
    "La adaptabilidad es esencial en un mundo cambiante.",
    "La colaboración multiplica los resultados.",
    "La integridad construye reputaciones duraderas.",
    "La visión a largo plazo supera las gratificaciones instantáneas.",
    "La autodisciplina es la base del alto rendimiento.",
    "La comunicación efectiva abre puertas.",
    "La estrategia bien ejecutada supera al talento no dirigido.",
    "La mentalidad positiva atrae soluciones.",
    "El enfoque en el cliente impulsa el crecimiento.",
    "La innovación requiere coraje y curiosidad.",
    "La planificación previa evita el desempeño pobre.",
    "La agilidad mental supera la rigidez.",
    "La excelencia operativa marca la diferencia.",
    "La responsabilidad personal genera confianza.",
    "La gestión del tiempo es gestión de la vida.",
    "La mejora continua es la vía hacia la maestría.",
    "La determinación supera a la duda.",
    "La empatía fortalece las relaciones profesionales.",
    "La toma de decisiones audaces impulsa el progreso.",
    "La simplicidad a menudo es la clave de la eficacia.",
    "El equilibrio entre vida y trabajo maximiza la productividad.",
    "La autenticidad atrae conexiones genuinas.",
    "La resiliencia convierte los fracasos en aprendizajes."
];

        // Función para mostrar una frase basada en el día del mes
        function displayDailyQuote() {
            const today = new Date();
            const dayOfMonth = today.getDate();
            const quoteIndex = (dayOfMonth - 1) % quotes.length;
            document.getElementById('dailyQuote').textContent = quotes[quoteIndex];
        }


        // Ejecutar al cargar la página
        window.onload = function() {
            displayDailyQuote();
            updateMissionsProgress(150, 2, 50); // Ejemplo inicial
        };

        function mostrarSeccion(seccionId) {
    // Ocultar todas las secciones
    document.querySelectorAll('.section').forEach(section => {
        section.classList.add('hidden');
        section.classList.remove('fade-in'); // Resetear la animación
    });

    // Mostrar la sección seleccionada
    const seccion = document.getElementById(seccionId);
    if (seccion) {
        seccion.classList.remove('hidden');
        // Agregar un pequeño retraso para que la animación funcione correctamente
        setTimeout(() => {
            seccion.classList.add('fade-in');
        }, 10);
    }

    // Actualizar el estado activo en el sidebar
    document.querySelectorAll('.sidebar button').forEach(btn => btn.classList.remove('active'));
    document.getElementById(`nav-${seccionId}`).classList.add('active');
}

        // Funciones dummy para evitar errores (puedes reemplazarlas con tu lógica)
        function abrirModal(modalId) { document.getElementById(modalId).classList.remove('hidden'); }
        function cerrarModal(modalId) { document.getElementById(modalId).classList.add('hidden'); }
        function filtrarInventario() {}
        function filtrarProductos() {}
        function agregarProductoVenta() {}
        function finalizarVenta() {}
        function imprimirTicket() {}
        function filtrarClientes() {}
        function agregarProductoFiar() {}
        function guardarFiado() {}
        function verFiado() {}
        function pagarFiado() {}
        function filtrarVentas() {}
        function limpiarFiltros() {}
        function descargarReporteVentasPDF() {}
        function calcularTotalFiado() {}
        function guardarConfig() {}
        function toggleTasaDolarInput() {}
        function calcularPrecioVentaBs() {}
        function actualizarPrecioVentaBs() {}
        function agregarProductoEditarFiado() {}
    </script>

<script>
    const { jsPDF } = window.jspdf;
    let inventario = [];
    let clientes = [];
    let ventas = [];
    let fiados = [];
    let proveedores = [];
    let carritoVenta = [];
    let carritoFiar = [];
    let carritoEditarFiado = [];
    let tasaDolar = 43.50;
    let tasaModo = 'manual';
    const itemsPorPagina = 5;
    let paginaActualVentas = 1;
    let ventasChartInstance = null;
let productosChartInstance = null;

    const sonidos = {
        click: new Howl({ src: ['https://cdn.pixabay.com/audio/2022/03/10/audio_1e1e1e1e1e.mp3'] }),
        success: new Howl({ src: ['https://cdn.pixabay.com/audio/2022/03/10/audio_2e2e2e2e2e.mp3'] }),
        error: new Howl({ src: ['https://cdn.pixabay.com/audio/2022/03/10/audio_3e3e3e3e3e.mp3'] })
    };

    window.addEventListener('load', async () => {
        document.getElementById('sistema').classList.remove('hidden');
        await cargarDatosIniciales();
        setTimeout(() => {
            document.getElementById('welcome-screen').style.display = 'none';
            actualizarTodo();
        }, 3000);
    });

    async function cargarDatosIniciales() {
    try {
        const [inventarioRes, clientesRes, ventasRes, fiadosRes, proveedoresRes, configRes] = await Promise.all([
            fetch('http://localhost:3000/productos'),
            fetch('http://localhost:3000/clientes'),
            fetch('http://localhost:3000/ventas'),
            fetch('http://localhost:3000/fiados'),
            fetch('http://localhost:3000/proveedores'),
            fetch('http://localhost:3000/config')
        ]);
        inventario = await inventarioRes.json();
        clientes = await clientesRes.json();
        ventas = await ventasRes.json();
        fiados = await fiadosRes.json();
        proveedores = await proveedoresRes.json();
        const config = await configRes.json();
        tasaDolar = parseFloat(config.tasaDolar) || 43.50;
        tasaModo = config.tasaModo || 'manual';
        document.getElementById('businessName').textContent = config.businessName || 'Mi Negocio';
        actualizarTasaDolar();
        actualizarProveedores();
    } catch (error) {
        notificar('Error al cargar datos iniciales', 'error');
        console.error(error);
    }
}

    async function mostrarSeccion(seccion) {
        document.getElementById('welcome-placeholder').style.display = 'none';
        document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
        document.getElementById(seccion).classList.remove('hidden');
        document.querySelectorAll('.sidebar button').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`nav-${seccion}`).classList.add('active');
        sonidos.click.play();
        if (seccion === 'ventas') actualizarSelectProductos('productosVenta');
        if (seccion === 'fiar') actualizarSelectProductos('productosFiar');
        if (seccion === 'reportes') {
            document.getElementById('buscarVenta').value = '';
            document.getElementById('filtroFecha').value = '';
            paginaActualVentas = 1;
            if (ventas.length === 0) {
                const ventasRes = await fetch('http://localhost:3000/ventas');
                ventas = await ventasRes.json();
            }
            generarReporteVentas();
        }
        if (seccion === 'dashboard') actualizarDashboard();
        if (seccion === 'proveedores') actualizarProveedores();
    }

    function abrirModal(id) {
        document.getElementById(id).classList.remove('hidden');
        sonidos.click.play();
    }

    function cerrarModal(id) {
        document.getElementById(id).classList.add('hidden');
        sonidos.click.play();
    }

    function notificar(mensaje, tipo) {
        Toastify({
            text: mensaje,
            duration: 3000,
            style: { background: tipo === 'success' ? '#22c55e' : '#ef4444' }
        }).showToast();
        sonidos[tipo === 'success' ? 'success' : 'error'].play();
    }

    function actualizarTodo() {
        actualizarInventario();
        actualizarClientes();
        actualizarFiados();
        actualizarDashboard();
        
        actualizarProveedores();
    }

    async function actualizarTasaDolar() {
        if (tasaModo === 'automatico') {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                tasaDolar = data.rates.VES || 43.50; // Usar VES para la tasa aproximada del BCV
                await fetch('http://localhost:3000/config', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ clave: 'tasaDolar', valor: tasaDolar.toString() })
                });
                notificar('Tasa del dólar actualizada automáticamente', 'success');
            } catch (error) {
                notificar('Error al actualizar la tasa automática, usando valor anterior', 'error');
                console.error('Error en actualizarTasaDolar:', error);
                return; // Evitar actualizar la UI si falla la API
            }
        }
        document.getElementById('tasaDolar').innerHTML = `${tasaDolar.toFixed(2)} Bs/USD <span id="tasaModo" class="text-sm">(${tasaModo})</span>`;
        actualizarPreciosVenta();
        actualizarCarrito('detalleVenta', carritoVenta, 'totalBsVenta', 'totalUsdVenta');
        actualizarCarrito('detalleFiar', carritoFiar, 'totalBsFiar', 'totalUsdFiar');
        recalcularTotalesFiados();
        actualizarFiados();
        
        setTimeout(actualizarTasaDolar, 300000);
    }

    function calcularPrecioVentaBs() {
    const precioVentaUsd = parseFloat(document.getElementById('precioVentaUsd').value) || 0;
    document.getElementById('precioVentaBs').value = (precioVentaUsd * tasaDolar).toFixed(2);
}

function calcularPrecioVentaUsd() {
    const precioVentaBs = parseFloat(document.getElementById('precioVentaBs').value) || 0;
    document.getElementById('precioVentaUsd').value = (precioVentaBs / tasaDolar).toFixed(2);
}

function actualizarPrecioVentaBs() {
    const precioVentaUsd = parseFloat(document.getElementById('editPrecioVentaUsd').value) || 0;
    document.getElementById('editPrecioVentaBs').value = (precioVentaUsd * tasaDolar).toFixed(2);
}

function actualizarPrecioVentaUsd() {
    const precioVentaBs = parseFloat(document.getElementById('editPrecioVentaBs').value) || 0;
    document.getElementById('editPrecioVentaUsd').value = (precioVentaBs / tasaDolar).toFixed(2);
}


    async function recalcularTotalesFiados() {
        fiados.forEach(async (fiado) => {
            fiado.total = fiado.productos.reduce((sum, p) => sum + (p.cantidad * p.precioVentaBs), 0);
            await fetch(`http://localhost:3000/fiados/${fiado.id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    fecha: fiado.fecha,
                    clienteId: fiado.clienteId || clientes.find(c => c.nombre === fiado.cliente)?.id,
                    total: fiado.total,
                    productos: fiado.productos.map(p => ({
                        id: p.productoId,
                        cantidad: p.cantidad,
                        precioVentaBs: p.precioVentaBs,
                        total: p.cantidad * p.precioVentaBs
                    }))
                })
            });
        });
    }

    function actualizarDashboard() {
    const hoy = new Date().toLocaleDateString();
    const ayer = new Date(Date.now() - 86400000).toLocaleDateString();
    const ventasHoy = ventas.filter(v => v.fecha.includes(hoy)).reduce((a, b) => a + b.total, 0);
    const ventasAyer = ventas.filter(v => v.fecha.includes(ayer)).reduce((a, b) => a + b.total, 0);
    const rendimiento = ventasAyer > 0 ? ((ventasHoy - ventasAyer) / ventasAyer * 100).toFixed(1) : 0;
    const stockBajo = inventario.filter(p => p.stock < 5).length;
    const fiadosPendientes = fiados.length;
    
    document.getElementById('ventasHoy').textContent = ventasHoy.toFixed(2) + ' Bs';
    document.getElementById('stockBajo').textContent = stockBajo;
    document.getElementById('totalClientes').textContent = clientes.length;
    document.getElementById('fiadosPendientes').textContent = fiadosPendientes;
    document.getElementById('rendimiento').textContent = `${rendimiento > 0 ? '+' : ''}${rendimiento}% vs ayer`;
    
    generarGraficoVentas();
    generarGraficoProductos();
    if (stockBajo > 0) notificar(`¡Alerta! ${stockBajo} productos con stock bajo`, 'error');
    if (fiadosPendientes > 0) notificar(`Tienes ${fiadosPendientes} fiados pendientes`, 'warning');
}

    document.getElementById('formProducto').addEventListener('submit', async (e) => {
        e.preventDefault();
        const producto = {
            nombre: document.getElementById('nombreProducto').value || 'Sin Nombre',
            precioCompraBs: parseFloat(document.getElementById('precioCompraBs').value) || 0,
            precioCompraUsd: parseFloat(document.getElementById('precioCompraUsd').value) || 0,
            precioVentaUsd: parseFloat(document.getElementById('precioVentaUsd').value) || 0,
            precioVentaBs: parseFloat(document.getElementById('precioVentaBs').value) || 0,
            stock: parseInt(document.getElementById('stockProducto').value) || 0
        };
        const response = await fetch('http://localhost:3000/productos', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(producto)
        });
        if (response.ok) {
            inventario = await (await fetch('http://localhost:3000/productos')).json();
            actualizarInventario();
            cerrarModal('modalProducto');
            notificar('Producto agregado', 'success');
            e.target.reset();
        } else {
            notificar('Error al agregar producto', 'error');
        }
    });

    document.getElementById('formEditarProducto').addEventListener('submit', async (e) => {
        e.preventDefault();
        const id = document.getElementById('editProductoIndex').value;
        const producto = {
            nombre: document.getElementById('editNombreProducto').value,
            precioCompraBs: parseFloat(document.getElementById('editPrecioCompraBs').value),
            precioCompraUsd: parseFloat(document.getElementById('editPrecioCompraUsd').value),
            precioVentaUsd: parseFloat(document.getElementById('editPrecioVentaUsd').value),
            precioVentaBs: parseFloat(document.getElementById('editPrecioVentaBs').value),
            stock: parseInt(document.getElementById('editStockProducto').value)
        };
        const response = await fetch(`http://localhost:3000/productos/${id}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(producto)
        });
        if (response.ok) {
            inventario = await (await fetch('http://localhost:3000/productos')).json();
            actualizarInventario();
            cerrarModal('modalEditarProducto');
            notificar('Producto editado', 'success');
        } else {
            notificar('Error al editar producto', 'error');
        }
    });

    function calcularPrecioVentaBs() {
        const precioVentaUsd = parseFloat(document.getElementById('precioVentaUsd').value) || 0;
        document.getElementById('precioVentaBs').value = (precioVentaUsd * tasaDolar).toFixed(2);
    }

    function actualizarPrecioVentaBs() {
        const precioVentaUsd = parseFloat(document.getElementById('editPrecioVentaUsd').value) || 0;
        document.getElementById('editPrecioVentaBs').value = (precioVentaUsd * tasaDolar).toFixed(2);
    }

    async function actualizarPreciosVenta() {
        for (const producto of inventario) {
            producto.precioVentaBs = producto.precioVentaUsd * tasaDolar;
            await fetch(`http://localhost:3000/productos/${producto.id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(producto)
            });
        }
        actualizarInventario();
    }

    function actualizarInventario() {
        filtrarInventario();
        actualizarSelectProductos('productosVenta');
        actualizarSelectProductos('productosFiar');
    }

    function filtrarInventario() {
    const busqueda = document.getElementById('buscarInventario').value.toLowerCase();
    const inventarioFiltrado = inventario.filter(p => 
        p.nombre.toLowerCase().includes(busqueda) || busqueda === ''
    );
    
    document.getElementById('tablaInventario').innerHTML = inventarioFiltrado.map(p => `
        <tr class="${p.stock < 5 ? 'producto-bajo-stock' : ''}">
            <td class="border p-2">${p.nombre}</td>
            <td class="border p-2">${p.precioCompraBs.toFixed(2)}</td>
            <td class="border p-2">${p.precioCompraUsd.toFixed(2)}</td>
            <td class="border p-2">${p.precioVentaBs.toFixed(2)}</td>
            <td class="border p-2">${p.precioVentaUsd.toFixed(2)}</td>
            <td class="border p-2">${p.stock}</td>
            <td class="border p-2">
                <button onclick="editarProducto(${p.id})" class="px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 mr-2">Editar</button>
                <button onclick="eliminarProducto(${p.id})" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700">Eliminar</button>
            </td>
        </tr>
    `).join('');
}
    function editarProducto(id) {
        const producto = inventario.find(p => p.id === id);
        document.getElementById('editProductoIndex').value = id;
        document.getElementById('editNombreProducto').value = producto.nombre;
        document.getElementById('editPrecioCompraBs').value = producto.precioCompraBs;
        document.getElementById('editPrecioCompraUsd').value = producto.precioCompraUsd;
        document.getElementById('editPrecioVentaUsd').value = producto.precioVentaUsd;
        document.getElementById('editPrecioVentaBs').value = producto.precioVentaBs;
        document.getElementById('editStockProducto').value = producto.stock;
        abrirModal('modalEditarProducto');
    }

    async function eliminarProducto(id) {
        const response = await fetch(`http://localhost:3000/productos/${id}`, {
            method: 'DELETE'
        });
        if (response.ok) {
            inventario = await (await fetch('http://localhost:3000/productos')).json();
            actualizarInventario();
            notificar('Producto eliminado', 'success');
        } else {
            notificar('Error al eliminar producto', 'error');
        }
    }

    function actualizarSelectProductos(id) {
        document.getElementById(id).innerHTML = inventario.map(p => 
            `<option value="${p.id}">${p.nombre} (Stock: ${p.stock}, Precio: ${p.precioVentaBs.toFixed(2)} Bs)</option>`
        ).join('');
    }

    function filtrarProductos(idSelect) {
        const busqueda = document.getElementById(`buscarProducto${idSelect === 'productosVenta' ? 'Venta' : 'Fiar'}`).value;
        const fuse = new Fuse(inventario, { keys: ['nombre'], threshold: 0.3 });
        const resultado = busqueda ? fuse.search(busqueda).map(r => r.item) : inventario;
        document.getElementById(idSelect).innerHTML = resultado.map(p => 
            `<option value="${p.id}">${p.nombre} (Stock: ${p.stock}, Precio: ${p.precioVentaBs.toFixed(2)} Bs)</option>`
        ).join('');
    }

    function agregarProductoVenta() {
        const select = document.getElementById('productosVenta');
        const producto = inventario.find(p => p.id === parseInt(select.value));
        const cantidad = parseInt(document.getElementById('cantidadVenta').value);
        if (cantidad > producto.stock) {
            notificar('No hay suficiente stock', 'error');
            return;
        }
        carritoVenta.push({ ...producto, cantidad, total: cantidad * producto.precioVentaBs });
        actualizarCarrito('detalleVenta', carritoVenta, 'totalBsVenta', 'totalUsdVenta');
        notificar('Producto agregado al carrito', 'success');
    }

    function actualizarCarrito(idTabla, carrito, idTotalBs, idTotalUsd) {
    // Si es la tabla de ventas, mostrar todos los detalles
    if (idTabla === 'detalleVenta') {
        document.getElementById(idTabla).innerHTML = carrito.map((p, i) => `
            <tr>
                <td class="border p-2">${p.nombre}</td>
                <td class="border p-2">${p.cantidad}</td>
                <td class="border p-2">
                    ${p.precioVentaBs.toFixed(2)} Bs<br>
                    ${(p.precioVentaBs / tasaDolar).toFixed(2)} USD
                </td>
                <td class="border p-2">${p.total.toFixed(2)}</td>
                <td class="border p-2">
                    <button onclick="editarProductoCarrito('Venta', ${i})" class="px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 mr-2">Editar</button>
                    <button onclick="eliminarProductoCarrito('Venta', ${i})" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700">Eliminar</button>
                </td>
            </tr>
        `).join('');
        
        const totalBs = carrito.reduce((a, b) => a + b.total, 0);
        document.getElementById(idTotalBs).textContent = totalBs.toFixed(2);
        document.getElementById(idTotalUsd).textContent = (totalBs / tasaDolar).toFixed(2);
    } 
    // Si es la tabla de fiados, mostrar solo producto y cantidad
    else if (idTabla === 'detalleFiar') {
        document.getElementById(idTabla).innerHTML = carrito.map((p, i) => `
            <tr>
                <td class="border p-2">${p.nombre}</td>
                <td class="border p-2">${p.cantidad}</td>
                <td class="border p-2">
                    <button onclick="editarProductoCarrito('Fiar', ${i})" class="px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 mr-2">Editar</button>
                    <button onclick="eliminarProductoCarrito('Fiar', ${i})" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700">Eliminar</button>
                </td>
            </tr>
        `).join('');
    }
}

    function editarProductoCarrito(tipo, index) {
        console.log(`Editando producto en ${tipo}, índice: ${index}`);
        const carrito = tipo === 'Venta' ? carritoVenta : carritoFiar;
        const producto = carrito[index];
        if (!producto) {
            console.error(`Producto no encontrado en ${tipo} en índice ${index}`);
            return;
        }
        document.getElementById(`editProducto${tipo}Index`).value = index;
        document.getElementById(`editNombreProducto${tipo}`).value = producto.nombre;
        document.getElementById(`editCantidadProducto${tipo}`).value = producto.cantidad;
        abrirModal(`modalEditarProducto${tipo}`);
    }

    document.getElementById('formEditarProductoVenta').addEventListener('submit', (e) => {
        e.preventDefault();
        const index = parseInt(document.getElementById('editProductoVentaIndex').value);
        const cantidad = parseInt(document.getElementById('editCantidadProductoVenta').value);
        const productoInventario = inventario.find(p => p.id === carritoVenta[index].id);
        if (cantidad > productoInventario.stock) {
            notificar('No hay suficiente stock', 'error');
            return;
        }
        carritoVenta[index].cantidad = cantidad;
        carritoVenta[index].total = cantidad * carritoVenta[index].precioVentaBs;
        actualizarCarrito('detalleVenta', carritoVenta, 'totalBsVenta', 'totalUsdVenta');
        cerrarModal('modalEditarProductoVenta');
        notificar('Producto editado en venta', 'success');
    });

    document.getElementById('formEditarProductoFiar').addEventListener('submit', (e) => {
        e.preventDefault();
        const index = parseInt(document.getElementById('editProductoFiarIndex').value);
        const cantidad = parseInt(document.getElementById('editCantidadProductoFiar').value);
        const productoInventario = inventario.find(p => p.id === carritoFiar[index].id);
        if (cantidad > productoInventario.stock) {
            notificar('No hay suficiente stock', 'error');
            return;
        }
        carritoFiar[index].cantidad = cantidad;
        carritoFiar[index].total = cantidad * carritoFiar[index].precioVentaBs;
        actualizarCarrito('detalleFiar', carritoFiar, 'totalBsFiar', 'totalUsdFiar');
        cerrarModal('modalEditarProductoFiar');
        notificar('Producto editado en fiado', 'success');
    });

    function eliminarProductoCarrito(tipo, index) {
        console.log(`Eliminando producto en ${tipo}, índice: ${index}`);
        const carrito = tipo === 'Venta' ? carritoVenta : carritoFiar;
        if (index >= 0 && index < carrito.length) {
            carrito.splice(index, 1);
            actualizarCarrito(tipo === 'Venta' ? 'detalleVenta' : 'detalleFiar', carrito, 
                tipo === 'Venta' ? 'totalBsVenta' : 'totalBsFiar', 
                tipo === 'Venta' ? 'totalUsdVenta' : 'totalUsdFiar');
            notificar(`Producto eliminado del carrito de ${tipo.toLowerCase()}`, 'success');
        } else {
            console.error(`Índice ${index} fuera de rango en ${tipo}`);
        }
    }

    async function finalizarVenta() {
    // Obtener datos del cliente (pueden estar vacíos)
    const nombreCliente = document.getElementById('nombreClienteVenta').value.trim() || 'Anónimo';
    const telefonoCliente = document.getElementById('telefonoClienteVenta').value.trim() || '';
    
    // Verificar si hay productos en el carrito
    if (carritoVenta.length === 0) {
        notificar('Agregue al menos un producto', 'error');
        return;
    }

    // Buscar o crear el cliente "Anónimo" si no hay nombre
    let clienteId = null;
    
    if (nombreCliente !== 'Anónimo') {
        // Buscar cliente existente
        clienteId = clientes.find(c => c.nombre === nombreCliente)?.id;
        
        // Si no existe, crear nuevo cliente
        if (!clienteId) {
            try {
                const response = await fetch('http://localhost:3000/clientes', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        nombre: nombreCliente,
                        telefono: telefonoCliente
                    })
                });
                const nuevoCliente = await response.json();
                clientes = await (await fetch('http://localhost:3000/clientes')).json();
                clienteId = nuevoCliente.id;
            } catch (error) {
                console.error('Error al crear cliente:', error);
                // Si falla la creación, usar "Anónimo" como fallback
                nombreCliente = 'Anónimo';
            }
        }
    }

    // Si es cliente anónimo, buscamos o creamos el registro
    if (nombreCliente === 'Anónimo') {
        const clienteAnonimo = clientes.find(c => c.nombre === 'Anónimo');
        if (!clienteAnonimo) {
            try {
                const response = await fetch('http://localhost:3000/clientes', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        nombre: 'Anónimo',
                        telefono: ''
                    })
                });
                const nuevoCliente = await response.json();
                clientes = await (await fetch('http://localhost:3000/clientes')).json();
                clienteId = nuevoCliente.id;
            } catch (error) {
                console.error('Error al crear cliente Anónimo:', error);
                clienteId = null; // Permitir venta sin cliente si falla
            }
        } else {
            clienteId = clienteAnonimo.id;
        }
    }

    // Calcular total de la venta
    const totalVenta = carritoVenta.reduce((a, b) => a + b.total, 0);
    
    // Crear objeto venta
    const venta = {
        fecha: new Date().toLocaleString(),
        clienteId: clienteId, // Puede ser null si no se pudo crear el cliente Anónimo
        cliente: nombreCliente, // Guardamos también el nombre por si acaso
        total: totalVenta,
        productos: carritoVenta.map(p => ({
            id: p.id,
            nombre: p.nombre,
            cantidad: p.cantidad,
            precioVentaBs: p.precioVentaBs,
            total: p.cantidad * p.precioVentaBs
        }))
    };

    try {
        // Registrar la venta
        const response = await fetch('http://localhost:3000/ventas', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(venta)
        });

        if (!response.ok) throw new Error('Error al registrar venta');

        // Actualizar stock de productos
        for (const p of carritoVenta) {
            const producto = inventario.find(i => i.id === p.id);
            producto.stock -= p.cantidad;
            await fetch(`http://localhost:3000/productos/${p.id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(producto)
            });
        }

        // Actualizar datos locales
        ventas = await (await fetch('http://localhost:3000/ventas')).json();
        inventario = await (await fetch('http://localhost:3000/productos')).json();
        
        // Limpiar carrito y campos
        carritoVenta = [];
        document.getElementById('nombreClienteVenta').value = '';
        document.getElementById('telefonoClienteVenta').value = '';
        document.getElementById('cantidadVenta').value = '';
        
        // Actualizar vistas
        actualizarCarrito('detalleVenta', carritoVenta, 'totalBsVenta', 'totalUsdVenta');
        actualizarClientes();
        actualizarInventario();
        
        notificar('Venta registrada', 'success');
        actualizarDashboard();
        
    } catch (error) {
        console.error('Error en finalizarVenta:', error);
        notificar('Error al registrar venta', 'error');
    }
}
function actualizarClientes() {
    filtrarClientes();
    const datalistVenta = document.getElementById('clientesList');
    const datalistFiar = document.getElementById('clientesListFiar');
    const opciones = clientes.map(c => `<option value="${c.nombre}">`).join('');
    datalistVenta.innerHTML = opciones;
    datalistFiar.innerHTML = opciones;
}

function filtrarClientes() {
    const busqueda = document.getElementById('buscarCliente').value.toLowerCase();
    const clientesFiltrados = clientes.filter(c => c.nombre.toLowerCase().includes(busqueda));
    document.getElementById('tablaClientes').innerHTML = clientesFiltrados.map(c => `
        <tr>
            <td class="border p-2">${c.nombre}</td>
            <td class="border p-2">${c.telefono || 'N/A'}</td> <!-- Muestra el teléfono -->
            <td class="border p-2">
                <button onclick="eliminarCliente(${c.id})" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700">Eliminar</button>
            </td>
        </tr>
    `).join('');
}
    async function eliminarCliente(id) {
        const response = await fetch(`http://localhost:3000/clientes/${id}`, {
            method: 'DELETE'
        });
        if (response.ok) {
            clientes = await (await fetch('http://localhost:3000/clientes')).json();
            actualizarClientes();
            notificar('Cliente eliminado', 'success');
        } else {
            notificar('Error al eliminar cliente', 'error');
        }
    }

    function agregarProductoFiar() {
        const select = document.getElementById('productosFiar');
        const producto = inventario.find(p => p.id === parseInt(select.value));
        const cantidad = parseInt(document.getElementById('cantidadFiar').value);
        if (cantidad > producto.stock) {
            notificar('No hay suficiente stock', 'error');
            return;
        }
        carritoFiar.push({ ...producto, cantidad, total: cantidad * producto.precioVentaBs });
        actualizarCarrito('detalleFiar', carritoFiar, 'totalBsFiar', 'totalUsdFiar');
        notificar('Producto agregado al fiado', 'success');
    }

    async function agregarProductoEditarFiado() {
    const select = document.getElementById('editProductosFiado');
    const producto = inventario.find(p => p.id === parseInt(select.value));
    const cantidad = parseInt(document.getElementById('editCantidadFiado').value) || 0;

    if (cantidad <= 0) {
        notificar('Ingrese una cantidad válida', 'error');
        return;
    }

    if (cantidad > producto.stock) {
        notificar('No hay suficiente stock', 'error');
        return;
    }

    // Agregar el producto al carrito de edición
    carritoEditarFiado.push({ 
        id: producto.id,
        nombre: producto.nombre,
        cantidad: cantidad,
        precioVentaBs: producto.precioVentaBs,
        total: cantidad * producto.precioVentaBs 
    });

    // Restar del inventario
    producto.stock -= cantidad;
    const response = await fetch(`http://localhost:3000/productos/${producto.id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(producto)
    });

    if (response.ok) {
        // Actualizar inventario global y notificar
        inventario = await (await fetch('http://localhost:3000/productos')).json();
        actualizarInventario();
        actualizarCarritoEditarFiado();
        notificar('Producto agregado al fiado y restado del inventario', 'success');
        document.getElementById('editCantidadFiado').value = '';
    } else {
        // Revertir si falla la actualización
        producto.stock += cantidad;
        carritoEditarFiado.pop();
        notificar('Error al actualizar el inventario', 'error');
    }
}

async function guardarFiado() {
    const nombreCliente = document.getElementById('nombreClienteFiar').value;
    const telefonoCliente = document.getElementById('telefonoClienteFiar').value || '';

    if (!nombreCliente) {
        notificar('Ingrese el nombre del cliente', 'error');
        return;
    }
    if (carritoFiar.length === 0) {
        notificar('Agregue al menos un producto', 'error');
        return;
    }

    let clienteId = clientes.find(c => c.nombre === nombreCliente)?.id;
    if (!clienteId) {
        const response = await fetch('http://localhost:3000/clientes', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                nombre: nombreCliente,
                telefono: telefonoCliente
            })
        });
        clientes = await (await fetch('http://localhost:3000/clientes')).json();
        clienteId = clientes.find(c => c.nombre === nombreCliente).id;
    }

    const fiado = {
        fecha: new Date().toLocaleString(),
        clienteId,
        productos: carritoFiar.map(p => ({
            id: p.id,
            cantidad: p.cantidad,
            precioVentaBs: p.precioVentaBs,
            total: p.cantidad * p.precioVentaBs
        }))
    };

    const response = await fetch('http://localhost:3000/fiados', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(fiado)
    });

    if (response.ok) {
        for (const p of carritoFiar) {
            const producto = inventario.find(i => i.id === p.id);
            producto.stock -= p.cantidad;
            await fetch(`http://localhost:3000/productos/${p.id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(producto)
            });
        }
        fiados = await (await fetch('http://localhost:3000/fiados')).json();
        inventario = await (await fetch('http://localhost:3000/productos')).json();
        carritoFiar = [];
        document.getElementById('nombreClienteFiar').value = '';
        document.getElementById('telefonoClienteFiar').value = '';
        document.getElementById('cantidadFiar').value = '';
        document.getElementById('buscarProductoFiar').value = '';
        actualizarCarrito('detalleFiar', carritoFiar, 'totalBsFiar', 'totalUsdFiar');
        actualizarFiados();
        actualizarInventario();
        notificar('Fiado registrado', 'success');
        
    } else {
        notificar('Error al registrar fiado', 'error');
    }
}
    function actualizarFiados() {
    document.getElementById('tablaFiados').innerHTML = fiados.map(f => `
        <tr>
            <td class="border p-2">${f.fecha}</td>
            <td class="border p-2">${f.cliente}</td>
            <td class="border p-2">
                <button onclick="editarFiado(${f.id})" class="px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 mr-2">Editar</button>
                <button onclick="eliminarFiado(${f.id})" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 mr-2">Eliminar</button>
                <button onclick="verFiado(${f.id})" class="px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 mr-2">Ver</button>
                <button onclick="pagarFiado(${f.id})" class="px-2 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700">Pagar Fiado</button>
            </td>
        </tr>
    `).join('');
}

    async function editarFiado(id) {
        const fiado = fiados.find(f => f.id === id);
        document.getElementById('editFiadoIndex').value = id;
        document.getElementById('editClienteFiado').value = fiado.cliente;
        carritoEditarFiado = fiado.productos.map(p => ({
            id: p.productoId || p.id,
            nombre: p.nombre,
            cantidad: p.cantidad,
            precioVentaBs: p.precioVentaBs,
            total: p.total
        }));
        actualizarSelectProductos('editProductosFiado');
        actualizarCarritoEditarFiado();
        abrirModal('modalEditarFiado');
    }

    function agregarProductoEditarFiado() {
        const select = document.getElementById('editProductosFiado');
        const producto = inventario.find(p => p.id === parseInt(select.value));
        const cantidad = parseInt(document.getElementById('editCantidadFiado').value) || 0;
        if (cantidad > producto.stock) {
            notificar('No hay suficiente stock', 'error');
            return;
        }
        carritoEditarFiado.push({ 
            id: producto.id,
            nombre: producto.nombre,
            cantidad: cantidad,
            precioVentaBs: producto.precioVentaBs,
            total: cantidad * producto.precioVentaBs 
        });
        actualizarCarritoEditarFiado();
        notificar('Producto agregado al fiado', 'success');
        document.getElementById('editCantidadFiado').value = '';
    }

    function actualizarCarritoEditarFiado() {
    document.getElementById('detalleEditarFiado').innerHTML = carritoEditarFiado.map((p, i) => `
        <tr>
            <td class="border p-2">${p.nombre}</td>
            <td class="border p-2">
                <input type="number" id="editCant_${i}" value="${p.cantidad}" class="w-full p-1 border rounded" onchange="actualizarCantidadEditarFiado(${i}, this.value)">
            </td>
            <td class="border p-2">
                <button onclick="eliminarProductoCarritoEditarFiado(${i})" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700">Eliminar</button>
            </td>
        </tr>
    `).join('');
}

    function actualizarCantidadEditarFiado(index, nuevaCantidad) {
        const cantidad = parseInt(nuevaCantidad) || 0;
        const productoInventario = inventario.find(p => p.id === carritoEditarFiado[index].id);
        const diferencia = cantidad - carritoEditarFiado[index].cantidad;

        if (diferencia > productoInventario.stock) {
            notificar('No hay suficiente stock', 'error');
            document.getElementById(`editCant_${index}`).value = carritoEditarFiado[index].cantidad;
            return;
        }

        carritoEditarFiado[index].cantidad = cantidad;
        carritoEditarFiado[index].total = cantidad * carritoEditarFiado[index].precioVentaBs;
        actualizarCarritoEditarFiado();
    }

    function eliminarProductoCarritoEditarFiado(index) {
        carritoEditarFiado.splice(index, 1);
        actualizarCarritoEditarFiado();
    }

    document.getElementById('formEditarFiado').addEventListener('submit', async (e) => {
        e.preventDefault();
        const id = parseInt(document.getElementById('editFiadoIndex').value);
        const clienteNombre = document.getElementById('editClienteFiado').value;
        let clienteId = clientes.find(c => c.nombre === clienteNombre)?.id;
        if (!clienteId) {
            await fetch('http://localhost:3000/clientes', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ nombre: clienteNombre })
            });
            clientes = await (await fetch('http://localhost:3000/clientes')).json();
            clienteId = clientes.find(c => c.nombre === clienteNombre).id;
        }
        const totalFiado = carritoEditarFiado.reduce((a, b) => a + b.total, 0);
        const fiado = {
            fecha: fiados.find(f => f.id === id).fecha,
            clienteId,
            total: totalFiado,
            productos: carritoEditarFiado.map(p => ({
                id: p.id,
                cantidad: p.cantidad,
                precioVentaBs: p.precioVentaBs,
                total: p.total
            }))
        };
        const response = await fetch(`http://localhost:3000/fiados/${id}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(fiado)
        });
        if (response.ok) {
            fiados = await (await fetch('http://localhost:3000/fiados')).json();
            inventario = await (await fetch('http://localhost:3000/productos')).json();
            actualizarFiados();
            actualizarInventario();
            cerrarModal('modalEditarFiado');
            notificar('Fiado editado', 'success');
            carritoEditarFiado = [];
           
        } else {
            notificar('Error al editar fiado', 'error');
        }
    });

    async function eliminarFiado(id) {
        const response = await fetch(`http://localhost:3000/fiados/${id}`, {
            method: 'DELETE'
        });
        if (response.ok) {
            fiados = await (await fetch('http://localhost:3000/fiados')).json();
            actualizarFiados();
            actualizarInventario();
            notificar('Fiado eliminado', 'success');
        } else {
            notificar('Error al eliminar fiado', 'error');
        }
    }

    async function verFiado(id) {
    const fiado = fiados.find(f => f.id === id);
    const cliente = fiado.cliente;
    const fiadosCliente = fiados.filter(f => f.cliente === cliente);
    let detalle = '';
    fiadosCliente.forEach(f => {
        f.productos.forEach(p => {
            detalle += `
                <tr>
                    <td class="border p-2">${p.nombre}</td>
                    <td class="border p-2">${p.cantidad}</td>
                </tr>
            `;
        });
    });
    document.getElementById('detalleVerFiado').innerHTML = `
        <p><strong>Cliente:</strong> ${cliente}</p>
        <div class="scrollable-table-container">
            <table class="w-full border-collapse holo rounded-lg">
                <thead><tr class="bg-gray-700"><th class="border p-2">Producto</th><th class="border p-2">Cantidad</th></tr></thead>
                <tbody>${detalle}</tbody>
            </table>
        </div>
    `;
    abrirModal('modalVerFiado');
}


async function pagarFiado(id) {
    const fiado = fiados.find(f => f.id === id);
    const clienteNombre = fiado.cliente;
    const clienteTelefono = fiado.telefono || ''; // Asegúrate de que el campo de teléfono esté disponible en el objeto fiado

    // Verificar si el cliente ya existe
    let cliente = clientes.find(c => c.nombre === clienteNombre);
    if (!cliente) {
        // Si el cliente no existe, lo registramos
        const response = await fetch('http://localhost:3000/clientes', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                nombre: clienteNombre,
                telefono: clienteTelefono // Añade el teléfono aquí
            })
        });
        if (response.ok) {
            cliente = await response.json();
            clientes.push(cliente); // Actualiza la lista de clientes localmente
            notificar('Cliente registrado automáticamente', 'success');
        } else {
            notificar('Error al registrar el cliente', 'error');
            return;
        }
    }

    // Registrar la venta
    const venta = {
        fecha: new Date().toLocaleString(),
        clienteId: cliente.id,
        total: fiado.total,
        productos: fiado.productos.map(p => ({
            id: p.id,
            cantidad: p.cantidad,
            precioVentaBs: p.precioVentaBs,
            total: p.total
        }))
    };

    const ventaResponse = await fetch('http://localhost:3000/ventas', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(venta)
    });

    if (ventaResponse.ok) {
        const deleteResponse = await fetch(`http://localhost:3000/fiados/${id}`, { method: 'DELETE' });
        if (deleteResponse.ok) {
            ventas = await (await fetch('http://localhost:3000/ventas')).json();
            fiados = await (await fetch('http://localhost:3000/fiados')).json();
            actualizarFiados();
            actualizarDashboard();
            
            notificar('Fiado pagado y registrado como venta', 'success');
        } else {
            notificar('Error al eliminar fiado', 'error');
        }
    } else {
        notificar('Error al registrar venta', 'error');
    }
}
    async function generarReporteVentas() {
    const busqueda = document.getElementById('buscarVenta').value.toLowerCase();
    const fechaFiltro = document.getElementById('filtroFecha').value;
    const tipoReporte = document.getElementById('tipoReporte').value;
    const response = await fetch('http://localhost:3000/ventas');
    let ventasData = await response.json();

    // Ordenar por fecha descendente
    ventasData = ventasData.sort((a, b) => new Date(b.fecha) - new Date(a.fecha));

    // Filtrar por cliente y fecha
    let ventasFiltradas = ventasData.filter(v => {
        const [dia, mes, anio] = v.fecha.split(',')[0].split('/');
        const fechaVenta = `${anio.trim()}-${mes.trim().padStart(2, '0')}-${dia.trim().padStart(2, '0')}`;
        return (v.cliente.toLowerCase().includes(busqueda) || busqueda === '') &&
               (!fechaFiltro || fechaVenta === fechaFiltro);
    });

    // Agrupar según tipo de reporte
    if (tipoReporte === 'semanal') {
        ventasFiltradas = agruparPorSemana(ventasFiltradas);
    } else if (tipoReporte === 'mensual') {
        ventasFiltradas = agruparPorMes(ventasFiltradas);
    }

    const totalBs = ventasFiltradas.reduce((a, b) => a + b.total, 0);
    const totalUsd = (totalBs / tasaDolar).toFixed(2);

    document.getElementById('reporteVentasBody').innerHTML = ventasFiltradas.map(v => `
        <tr>
            <td class="border p-2">${tipoReporte === 'diario' ? v.fecha : v.periodo}</td>
            <td class="border p-2">${v.cliente}</td>
            <td class="border p-2 text-right">${v.total.toFixed(2)}</td>
            <td class="border p-2 text-right">${(v.total / tasaDolar).toFixed(2)}</td>
            <td class="border p-2 text-center">
                ${tipoReporte === 'diario' ? `<button onclick="verVenta(${v.id})" class="px-2 py-1 bg-teal-500 text-white hover:bg-teal-600">Ver</button>` : ''}
            </td>
        </tr>
    `).join('');

    document.getElementById('totalBsReporte').textContent = totalBs.toFixed(2);
    document.getElementById('totalUsdReporte').textContent = totalUsd;
}

function filtrarVentas() {
    generarReporteVentas();
}

function limpiarFiltros() {
    document.getElementById('buscarVenta').value = '';
    document.getElementById('filtroFecha').value = '';
    document.getElementById('tipoReporte').value = 'diario';
    document.getElementById('reporteVentasBody').innerHTML = ''; // Limpiar el contenedor de reportes
    document.getElementById('totalBsReporte').textContent = '0.00'; // Reiniciar total en Bs
    document.getElementById('totalUsdReporte').textContent = '0.00'; // Reiniciar total en USD
}

function agruparPorSemana(ventas) {
    const semanas = {};
    ventas.forEach(v => {
        const fecha = new Date(v.fecha.split(',')[0].split('/').reverse().join('-'));
        const inicioSemana = new Date(fecha);
        inicioSemana.setDate(fecha.getDate() - fecha.getDay());
        const key = `${inicioSemana.toLocaleDateString()}`;
        if (!semanas[key]) {
            semanas[key] = { periodo: `Semana del ${key}`, total: 0, cliente: 'Múltiples', productos: [] };
        }
        semanas[key].total += v.total;
        semanas[key].productos.push(...v.productos);
    });
    return Object.values(semanas);
}

function agruparPorMes(ventas) {
    const meses = {};
    ventas.forEach(v => {
        const fecha = new Date(v.fecha.split(',')[0].split('/').reverse().join('-'));
        const key = `${fecha.getFullYear()}-${(fecha.getMonth() + 1).toString().padStart(2, '0')}`;
        if (!meses[key]) {
            meses[key] = { periodo: `${fecha.toLocaleString('default', { month: 'long' })} ${fecha.getFullYear()}`, total: 0, cliente: 'Múltiples', productos: [] };
        }
        meses[key].total += v.total;
        meses[key].productos.push(...v.productos);
    });
    return Object.values(meses);
}

async function verVenta(id) {
    const venta = ventas.find(v => v.id === id);
    document.getElementById('detalleVerVenta').innerHTML = `
        <p><strong>Fecha:</strong> ${venta.fecha}</p>
        <p><strong>Cliente:</strong> ${venta.cliente}</p>
        <div class="scrollable-table-container">
            <table class="w-full border-collapse holo">
                <thead>
                    <tr class="bg-gray-700">
                        <th class="border p-2">Producto</th>
                        <th class="border p-2">Cantidad</th>
                        <th class="border p-2">Precio (Bs)</th>
                        <th class="border p-2">Total (Bs)</th>
                    </tr>
                </thead>
                <tbody>
                    ${venta.productos.map(p => `
                        <tr>
                            <td class="border p-2">${p.nombre}</td>
                            <td class="border p-2">${p.cantidad}</td>
                            <td class="border p-2">${p.precioVentaBs.toFixed(2)}</td>
                            <td class="border p-2">${p.total.toFixed(2)}</td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        </div>
        <p class="mt-2"><strong>Total:</strong> ${venta.total.toFixed(2)} Bs (${(venta.total / tasaDolar).toFixed(2)} USD)</p>
    `;
    abrirModal('modalVerVenta');
}

async function descargarReporteVentasPDF() {
    try {
        // Obtener parámetros de filtrado
        const busqueda = document.getElementById('buscarVenta').value.toLowerCase();
        const fechaFiltro = document.getElementById('filtroFecha').value;
        const tipoReporte = document.getElementById('tipoReporte').value;

        // Obtener ventas del servidor
        const response = await fetch('http://localhost:3000/ventas');
        let ventas = await response.json();

        // Función para normalizar fechas
        const normalizarFechaVenta = (fechaVenta) => {
            // Asume formato "DD/MM/YYYY, HH:MM:SS" o similar
            const [fechaPart] = fechaVenta.split(',');
            const [dia, mes, anio] = fechaPart.trim().split('/');
            return `${anio}-${mes.padStart(2, '0')}-${dia.padStart(2, '0')}`;
        };

        // Filtrar ventas
        const ventasFiltradas = ventas.filter(v => {
            // Filtrar por cliente
            const coincideCliente = v.cliente?.toLowerCase().includes(busqueda) || busqueda === '';
            
            // Filtrar por fecha si se especificó
            let coincideFecha = true;
            if (fechaFiltro) {
                const fechaVentaNormalizada = normalizarFechaVenta(v.fecha);
                coincideFecha = fechaVentaNormalizada === fechaFiltro;
            }
            
            return coincideCliente && coincideFecha;
        });

        if (ventasFiltradas.length === 0) {
            notificar('No hay ventas que coincidan con los filtros aplicados', 'warning');
            return;
        }

        // Crear PDF
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Configuración
        const businessName = document.getElementById('businessName').textContent;
        const fechaGeneracion = new Date().toLocaleString();
        const pageWidth = doc.internal.pageSize.getWidth();
        const margin = 15;
        let startY = 20; // Posición vertical inicial

        // Función para agregar nueva página si es necesario
        const checkPageBreak = (neededSpace) => {
            const pageHeight = doc.internal.pageSize.getHeight();
            if (startY + neededSpace > pageHeight - 20) {
                doc.addPage();
                startY = 20;
            }
        };

        // Encabezado principal (solo en la primera página)
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(18);
        doc.text(businessName, pageWidth / 2, startY, { align: 'center' });
        startY += 10;

        doc.setFontSize(14);
        doc.text('REPORTE DETALLADO DE VENTAS', pageWidth / 2, startY, { align: 'center' });
        startY += 15;

        // Información del reporte
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(10);
        doc.text(`Fecha de generación: ${fechaGeneracion}`, margin, startY);
        startY += 5;
        
        if (busqueda) {
            doc.text(`Cliente filtrado: ${busqueda}`, margin, startY);
            startY += 5;
        }
        
        if (fechaFiltro) {
            doc.text(`Fecha filtrada: ${fechaFiltro}`, margin, startY);
            startY += 5;
        }

        // Espacio antes de empezar con las ventas
        startY += 10;

        // Procesar cada venta
        ventasFiltradas.forEach((venta, index) => {
            checkPageBreak(50); // Verificar espacio para la siguiente venta

            // Encabezado de venta individual
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.setTextColor(41, 128, 185); // Azul
            doc.text(`Venta #${index + 1} - ${venta.fecha}`, margin, startY);
            startY += 7;

            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0); // Negro
            doc.text(`Cliente: ${venta.cliente || 'No especificado'}`, margin, startY);
            startY += 5;

            // Tabla de productos
            const productosHeaders = [['Producto', 'Cantidad', 'P. Unit. (Bs)', 'Total (Bs)', 'Total (USD)']];
            const productosData = venta.productos.map(p => [
                p.nombre,
                p.cantidad,
                p.precioVentaBs.toFixed(2),
                p.total.toFixed(2),
                (p.total / tasaDolar).toFixed(2)
            ]);

            doc.autoTable({
                startY: startY,
                head: productosHeaders,
                body: productosData,
                margin: { left: margin, right: margin },
                styles: { 
                    fontSize: 9, 
                    cellPadding: 3,
                    textColor: [50, 50, 50]
                },
                headStyles: { 
                    fillColor: [41, 128, 185], 
                    textColor: 255,
                    fontSize: 9
                },
                alternateRowStyles: {
                    fillColor: [245, 245, 245]
                },
                didDrawPage: function(data) {
                    startY = data.cursor.y + 10;
                }
            });

            // Total de la venta
            const totalVenta = venta.productos.reduce((sum, p) => sum + p.total, 0);
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(10);
            doc.text(`Total Venta: ${totalVenta.toFixed(2)} Bs (${(totalVenta / tasaDolar).toFixed(2)} USD)`, 
                    pageWidth - margin, startY, { align: 'right' });
            
            // Espacio entre ventas
            startY += 15;
            
            // Línea divisoria
            doc.setDrawColor(200, 200, 200);
            doc.setLineWidth(0.3);
            doc.line(margin, startY, pageWidth - margin, startY);
            
            startY += 10;
        });

        // Totales generales (en la última página)
        checkPageBreak(30);

        doc.setFont('helvetica', 'bold');
        doc.setFontSize(12);
        const totalGeneralBs = ventasFiltradas.reduce((sum, v) => sum + v.total, 0);
        const totalGeneralUsd = totalGeneralBs / tasaDolar;
        
        doc.text(`Resumen General:`, margin, startY);
        startY += 7;
        
        doc.text(`Total de ventas: ${ventasFiltradas.length}`, margin, startY);
        startY += 7;
        
        doc.text(`Total en Bs: ${totalGeneralBs.toFixed(2)}`, margin, startY);
        startY += 7;
        
        doc.text(`Total en USD: ${totalGeneralUsd.toFixed(2)}`, margin, startY);
        startY += 7;

        // Pie de página
        doc.setFont('helvetica', 'italic');
        doc.setFontSize(8);
        doc.setTextColor(150, 150, 150);
        doc.text(`Sistema Operix - ${fechaGeneracion}`, pageWidth / 2, 290, { align: 'center' });

        // Guardar PDF
        const nombreArchivo = `Reporte_Detallado_Ventas_${businessName.replace(/ /g, '_')}` + 
                             `${fechaFiltro ? '_' + fechaFiltro : ''}` + 
                             `${busqueda ? '_' + busqueda : ''}.pdf`;
        
        doc.save(nombreArchivo);

        notificar('Reporte detallado generado exitosamente', 'success');
    } catch (error) {
        console.error('Error al generar PDF:', error);
        notificar('Error al generar el reporte PDF: ' + error.message, 'error');
    }
}
 

document.getElementById('formProveedor').addEventListener('submit', async (e) => {
    e.preventDefault();
    const proveedor = {
        nombre: document.getElementById('nombreProveedor').value,
        contacto: document.getElementById('contactoProveedor').value,
        productos: document.getElementById('productosProveedor').value // Enviar como texto directamente
    };
    const response = await fetch('http://localhost:3000/proveedores', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(proveedor)
    });
    if (response.ok) {
        proveedores = await (await fetch('http://localhost:3000/proveedores')).json();
        actualizarProveedores();
        cerrarModal('modalProveedor');
        notificar('Proveedor agregado', 'success');
        e.target.reset();
    } else {
        notificar('Error al agregar proveedor', 'error');
    }
});
function actualizarProveedores() {
    document.getElementById('tablaProveedores').innerHTML = proveedores.map(p => `
        <tr>
            <td class="border p-2">${p.nombre}</td>
            <td class="border p-2">${p.contacto}</td>
            <td class="border p-2">${p.productos}</td> <!-- Mostrar directamente como texto -->
            <td class="border p-2">
                <button onclick="eliminarProveedor(${p.id})" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700">Eliminar</button>
            </td>
        </tr>
    `).join('');
}


    async function eliminarProveedor(id) {
        const response = await fetch(`http://localhost:3000/proveedores/${id}`, {
            method: 'DELETE'
        });
        if (response.ok) {
            proveedores = await (await fetch('http://localhost:3000/proveedores')).json();
            actualizarProveedores();
            notificar('Proveedor eliminado', 'success');
        } else {
            notificar('Error al eliminar proveedor', 'error');
        }
    }

    // Mantengo las declaraciones iniciales y funciones previas sin cambios hasta Configuración

    // Nueva función para habilitar/deshabilitar el campo de tasa según el modo
    document.addEventListener('DOMContentLoaded', () => {
    // Escuchar cambios en el menú desplegable de la tasa
    const selectTasaModo = document.getElementById('configTasaModo');
    if (selectTasaModo) {
        selectTasaModo.addEventListener('change', toggleTasaDolarInput);
    }
});

function toggleTasaDolarInput() {
    const modo = document.getElementById('configTasaModo').value;
    const tasaInput = document.getElementById('configTasaDolar');
    if (modo === 'manual') {
        tasaInput.removeAttribute('disabled'); // Habilitar el campo
        tasaInput.focus(); // Enfocar el campo para edición inmediata
    } else {
        tasaInput.setAttribute('disabled', 'true'); // Deshabilitar el campo
        actualizarTasaDolar(); // Actualizar la tasa automáticamente
    }
}

document.getElementById('nav-config').addEventListener('click', () => {
    mostrarSeccion('config'); // Mostrar la sección
    document.getElementById('configBusinessName').value = document.getElementById('businessName').textContent;
    document.getElementById('configTasaDolar').value = tasaDolar.toFixed(2);
    document.getElementById('configTasaModo').value = tasaModo;
    toggleTasaDolarInput(); // Aplicar el modo actual al cargar la sección
});
    // Función para actualizar la tasa del dólar
    async function actualizarTasaDolar() {
        if (tasaModo === 'automatico') {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                tasaDolar = data.rates.VES || 43.50; // Usar VES para la tasa aproximada del BCV
                await fetch('http://localhost:3000/config', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ clave: 'tasaDolar', valor: tasaDolar.toString() })
                });
                document.getElementById('tasaDolar').innerHTML = `${tasaDolar.toFixed(2)} Bs/USD <span id="tasaModo" class="text-sm">(automático)</span>`;
                document.getElementById('configTasaDolar').value = tasaDolar.toFixed(2); // Actualiza el campo
                notificar('Tasa del dólar actualizada automáticamente', 'success');
            } catch (error) {
                notificar('Error al actualizar la tasa automática, usando valor anterior', 'error');
                console.error('Error en actualizarTasaDolar:', error);
                return;
            }
        } else {
            // Modo manual: solo actualiza la UI con el valor actual
            document.getElementById('tasaDolar').innerHTML = `${tasaDolar.toFixed(2)} Bs/USD <span id="tasaModo" class="text-sm">(manual)</span>`;
        }

        // Actualiza todo lo que depende de la tasa
        actualizarPreciosVenta();
        actualizarCarrito('detalleVenta', carritoVenta, 'totalBsVenta', 'totalUsdVenta');
        actualizarCarrito('detalleFiar', carritoFiar, 'totalBsFiar', 'totalUsdFiar');
        recalcularTotalesFiados();
        actualizarFiados();
        

        // Solo programa la próxima actualización si está en modo automático
        if (tasaModo === 'automatico') {
            setTimeout(actualizarTasaDolar, 300000); // 5 minutos
        }
    }

    async function guardarConfig() {
    const nuevoModo = document.getElementById('configTasaModo').value;
    const tasaIngresada = parseFloat(document.getElementById('configTasaDolar').value) || tasaDolar;
    const businessName = document.getElementById('configBusinessName').value || 'Mi Negocio';
    
    // Validación básica
    if (isNaN(tasaIngresada) || tasaIngresada <= 0) {
        notificar('Ingrese una tasa de dólar válida', 'error');
        return;
    }

    try {
        // Preparar todas las solicitudes
        const requests = [
            fetch('http://localhost:3000/config', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ clave: 'businessName', valor: businessName })
            }),
            fetch('http://localhost:3000/config', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ clave: 'tasaDolar', valor: tasaIngresada.toString() })
            }),
            fetch('http://localhost:3000/config', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ clave: 'tasaModo', valor: nuevoModo })
            })
        ];

        // Esperar todas las respuestas
        const responses = await Promise.all(requests);
        
        // Verificar que todas las respuestas sean OK
        const allSuccess = responses.every(r => r.ok);
        if (!allSuccess) {
            throw new Error('Algunas configuraciones no se guardaron correctamente');
        }

        // Actualizar UI solo si todo fue exitoso
        document.getElementById('businessName').textContent = businessName;
        tasaModo = nuevoModo;
        tasaDolar = tasaIngresada;

        // Actualizar según el modo
        if (tasaModo === 'automatico') {
            await actualizarTasaDolar(); // Actualiza desde la API
        } else {
            // Modo manual: usa el valor ingresado
            document.getElementById('tasaDolar').innerHTML = `${tasaDolar.toFixed(2)} Bs/USD <span id="tasaModo" class="text-sm">(manual)</span>`;
        }

        // Mostrar notificación de éxito
        notificar('Configuración guardada correctamente', 'success');

        // Actualizar dependencias
        actualizarPreciosVenta();
        actualizarCarrito('detalleVenta', carritoVenta, 'totalBsVenta', 'totalUsdVenta');
        actualizarCarrito('detalleFiar', carritoFiar, 'totalBsFiar', 'totalUsdFiar');
        
    } catch (error) {
        console.error('Error en guardarConfig:', error);
        notificar('Error al guardar la configuración: ' + error.message, 'error');
        
        // Revertir cambios en la UI si es necesario
        document.getElementById('configTasaDolar').value = tasaDolar;
        document.getElementById('configTasaModo').value = tasaModo;
        document.getElementById('configBusinessName').value = document.getElementById('businessName').textContent;
    }
}

    function generarGraficoVentas() {
        const ctx = document.getElementById('ventasChart').getContext('2d');
        if (window.ventasChart instanceof Chart) {
            window.ventasChart.destroy();
        }
        const ultimos7Dias = Array.from({ length: 7 }, (_, i) => {
            const fecha = new Date();
            fecha.setDate(fecha.getDate() - i);
            return fecha.toLocaleDateString();
        }).reverse();
        const ventasPorDia = ultimos7Dias.map(dia => {
            return ventas.filter(v => v.fecha.includes(dia)).reduce((a, b) => a + b.total, 0);
        });
        window.ventasChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ultimos7Dias,
                datasets: [{
                    label: 'Ventas (Bs)',
                    data: ventasPorDia,
                    borderColor: '#ffcc00',
                    fill: false
                }]
            },
            options: { scales: { y: { beginAtZero: true } } }
        });
    }

    function generarGraficoProductos() {
        const ctx = document.getElementById('productosChart').getContext('2d');
        if (window.productosChart instanceof Chart) {
            window.productosChart.destroy();
        }
        const productosVendidos = {};
        ventas.forEach(v => v.productos.forEach(p => {
            productosVendidos[p.id] = (productosVendidos[p.id] || 0) + p.cantidad;
        }));
        const topProductos = Object.entries(productosVendidos)
            .map(([id, cantidad]) => ({
                nombre: inventario.find(p => p.id === parseInt(id))?.nombre || 'Desconocido',
                cantidad
            }))
            .sort((a, b) => b.cantidad - a.cantidad)
            .slice(0, 5);
        window.productosChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: topProductos.map(p => p.nombre),
                datasets: [{
                    label: 'Unidades Vendidas',
                    data: topProductos.map(p => p.cantidad),
                    backgroundColor: '#00ced1'
                }]
            },
            options: { scales: { y: { beginAtZero: true } } }
        });
    }


   
    
   
   
async function imprimirTicket(tipo) {
    const carrito = tipo === 'venta' ? carritoVenta : carritoFiar;
    const cliente = tipo === 'venta' ? 
        document.getElementById('nombreClienteVenta').value || 'CLIENTE ANÓNIMO' : 
        document.getElementById('nombreClienteFiar').value;
    const totalBs = carrito.reduce((a, b) => a + b.total, 0);
    const totalUsd = (totalBs / tasaDolar).toFixed(2);
    const businessName = document.getElementById('businessName').textContent.toUpperCase();
    const fecha = new Date().toLocaleString();
    
    const printWindow = window.open('', '_blank');
    
    printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Ticket de ${tipo === 'venta' ? 'Venta' : 'Fiado'}</title>
            <style>
                @page {
                    size: auto;
                    margin: 0mm;
                }
                body {
                    font-family: 'Courier New', monospace;
                    width: 58mm;
                    margin: 0;
                    padding: 3mm;
                    font-size: 10px;
                    line-height: 1.3;
                }
                .header {
                    text-align: center;
                    font-weight: bold;
                    margin-bottom: 3mm;
                    padding-bottom: 2mm;
                    border-bottom: 1px dashed #000;
                }
                .business-name {
                    font-size: 12px;
                    margin-bottom: 1mm;
                }
                .ticket-type {
                    font-size: 11px;
                }
                .info {
                    margin-bottom: 3mm;
                }
                table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-bottom: 3mm;
                    table-layout: fixed;
                }
                th {
                    text-align: left;
                    padding: 1mm 0;
                    border-bottom: 1px dashed #000;
                }
                td {
                    padding: 1mm 0;
                    vertical-align: top;
                    overflow: hidden;
                }
                .producto {
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }
                .cantidad {
                    text-align: center;
                    width: 15mm;
                }
                .total {
                    text-align: right;
                    width: 20mm;
                }
                .totals {
                    margin-top: 3mm;
                    padding-top: 2mm;
                    border-top: 1px dashed #000;
                }
                .total-row {
                    display: flex;
                    justify-content: space-between;
                    margin-bottom: 1mm;
                }
                .footer {
                    text-align: center;
                    margin-top: 3mm;
                    padding-top: 2mm;
                    border-top: 1px dashed #000;
                    font-size: 9px;
                }
            </style>
        </head>
        <body>
            <div class="header">
                <div class="business-name">${businessName}</div>
                <div class="ticket-type">TICKET DE ${tipo === 'venta' ? 'VENTA' : 'FIADO'}</div>
            </div>
            
            <div class="info">
                <div><strong>Fecha:</strong> ${fecha}</div>
                <div><strong>Cliente:</strong> ${cliente.toUpperCase()}</div>
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th style="width: 60%">Producto</th>
                        <th style="width: 15%">Cant.</th>
                        <th style="width: 25%">Total</th>
                    </tr>
                </thead>
                <tbody>
                    ${carrito.map(p => `
                        <tr>
                            <td class="producto" title="${p.nombre.toUpperCase()}">${p.nombre.toUpperCase()}</td>
                            <td class="cantidad">${p.cantidad}</td>
                            <td class="total">${p.total.toFixed(2)}</td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
            
            <div class="totals">
                <div class="total-row">
                    <span>Subtotal:</span>
                    <span>${totalBs.toFixed(2)}</span>
                </div>
                <div class="total-row">
                    <span>Tasa USD:</span>
                    <span>${tasaDolar.toFixed(2)} Bs/USD</span>
                </div>
                <div class="total-row" style="font-weight: bold;">
                    <span>TOTAL:</span>
                    <span>${totalBs.toFixed(2)} Bs (${totalUsd} USD)</span>
                </div>
            </div>
            
            <div class="footer">
                <div>¡Gracias por su compra!</div>
                <div>${businessName}</div>
                ${tipo === 'fiar' ? '<div style="font-weight: bold;">** FIADO - PENDIENTE DE PAGO **</div>' : ''}
            </div>

            <script>
                window.print();
                setTimeout(function() {
                    window.close();
                }, 100);
            </script>
        </body>
        </html>
    `);
    
    printWindow.document.close();

    
    // Si es una venta, actualizar inventario y limpiar
    if (tipo === 'venta' && carritoVenta.length > 0) {
        try {
            // Actualizar stock de productos
            for (const p of carritoVenta) {
                const producto = inventario.find(i => i.id === p.id);
                if (producto) {
                    producto.stock -= p.cantidad;
                    await fetch(`http://localhost:3000/productos/${p.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(producto)
                    });
                }
            }
            
            // Limpiar carrito y campos
            carritoVenta = [];
            document.getElementById('nombreClienteVenta').value = '';
            document.getElementById('telefonoClienteVenta').value = '';
            document.getElementById('cantidadVenta').value = '';
            
            // Actualizar vistas
            actualizarCarrito('detalleVenta', carritoVenta, 'totalBsVenta', 'totalUsdVenta');
            actualizarInventario();
            
            notificar('Venta completada e inventario actualizado', 'success');
            
            // Actualizar dashboard y misiones
            actualizarDashboard();
        
        } catch (error) {
            console.error('Error al actualizar inventario:', error);
            notificar('Error al actualizar inventario', 'error');
        }
    }
    
    // Opción alternativa para impresión directa
    setTimeout(() => {
        if (printWindow.closed || typeof printWindow.print === 'undefined') {
            const printDiv = document.createElement('div');
            printDiv.style.position = 'absolute';
            printDiv.style.left = '-9999px';
            printDiv.innerHTML = `
                <div style="font-family: Arial; width: 80mm; padding: 10px 15px; background: white; color: #333;">
                    <div style="text-align: center; margin-bottom: 12px; padding-bottom: 10px; border-bottom: 2px dashed #e0e0e0;">
                        <div style="font-weight: bold; font-size: 18px; margin-bottom: 4px; color: #2c3e50; letter-spacing: 1px;">${businessName}</div>
                        <div style="font-size: 14px; font-weight: bold; color: ${tipo === 'venta' ? '#27ae60' : '#e74c3c'}; margin-bottom: 6px; text-transform: uppercase;">
                            Ticket de ${tipo === 'venta' ? 'Venta' : 'Fiado'}
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 12px; font-size: 11px; line-height: 1.4;">
                        <div><span style="font-weight: bold; color: #7f8c8d;">Fecha:</span> ${fecha}</div>
                        <div><span style="font-weight: bold; color: #7f8c8d;">Cliente:</span> ${cliente}</div>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 12px; font-size: 11px;">
                        <thead>
                            <tr>
                                <th style="text-align: left; padding: 6px 0; border-bottom: 2px solid #e0e0e0; color: #7f8c8d; font-weight: bold;">Producto</th>
                                <th style="text-align: right; padding: 6px 0; border-bottom: 2px solid #e0e0e0; color: #7f8c8d; font-weight: bold;">Cant.</th>
                                <th style="text-align: right; padding: 6px 0; border-bottom: 2px solid #e0e0e0; color: #7f8c8d; font-weight: bold;">P. Unit.</th>
                                <th style="text-align: right; padding: 6px 0; border-bottom: 2px solid #e0e0e0; color: #7f8c8d; font-weight: bold;">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${carrito.map(p => `
                                <tr>
                                    <td style="padding: 6px 0; border-bottom: 1px dashed #eee; vertical-align: top;">${p.nombre}</td>
                                    <td style="padding: 6px 0; border-bottom: 1px dashed #eee; vertical-align: top; text-align: right;">${p.cantidad}</td>
                                    <td style="padding: 6px 0; border-bottom: 1px dashed #eee; vertical-align: top; text-align: right;">${p.precioVentaBs.toFixed(2)}</td>
                                    <td style="padding: 6px 0; border-bottom: 1px dashed #eee; vertical-align: top; text-align: right;">${p.total.toFixed(2)}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div style="margin-top: 12px; padding-top: 10px; border-top: 2px dashed #e0e0e0; font-size: 12px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                            <span style="font-weight: bold; color: #7f8c8d;">Subtotal:</span>
                            <span style="font-weight: bold; color: #2c3e50;">${totalBs.toFixed(2)} Bs</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                            <span style="font-weight: bold; color: #7f8c8d;">Tasa USD:</span>
                            <span style="font-weight: bold; color: #2c3e50;">${tasaDolar.toFixed(2)} Bs/USD</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 14px; color: ${tipo === 'venta' ? '#27ae60' : '#e74c3c'};">
                            <span style="font-weight: bold;">TOTAL:</span>
                            <span style="font-weight: bold;">${totalBs.toFixed(2)} Bs (${totalUsd} USD)</span>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 15px; font-size: 10px; color: #95a5a6; padding-top: 10px; border-top: 2px dashed #e0e0e0;">
                        <div style="font-style: italic; margin-bottom: 5px;">¡Gracias por su preferencia!</div>
                        <div>${businessName}</div>
                        ${tipo === 'fiar' ? '<div style="color: #e74c3c; font-weight: bold; margin-top: 8px; font-size: 11px;">** FIADO - PENDIENTE DE PAGO **</div>' : ''}
                    </div>
                </div>
            `;
            
            document.body.appendChild(printDiv);
            window.print();
            setTimeout(() => document.body.removeChild(printDiv), 1000);
        }
    }, 500);
}


</script>

</body>
</html>
